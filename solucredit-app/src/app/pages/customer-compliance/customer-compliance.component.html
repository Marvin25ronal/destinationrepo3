
<div class="row">
    <div class="col-md-12 rounded-pill">
        <ngx-spinner bdColor="rgba(51,51,51,0.8)" size="medium" color="#759ee0" type="ball-scale-multiple">
            <p style="font-size: 20px; color:#fff">Cargando Información...</p>
        </ngx-spinner>
        <div class="row">
            <div class="col-md-4 col-sm-12">
                <div class="card h-100" style="border: 3px solid #0C4271;
                border-radius: 30px; background-color: #0C4271;">
                    <div class="card-header text-white text-center align-items-center" style="background-color: #0C4271;">
                        <span class="text-white display-6"><i class="ti-user font-24"></i></span>
                        <div class="d-inline-block m-l-15">
                            <span *ngIf="dataCustomer && dataCustomer.type === 0 && dataCustomer" class="font-15">{{dataCustomer.name}}</span>
                            <span *ngIf="dataCustomer && dataCustomer.type === 1 && dataCustomer" class="font-15">{{dataCustomer.businessname}}</span>
                        </div>
                    </div>
                    <div class="card-body" style="background-color: #fff; padding-block-end: 5%;">
                        <div class="row mb-2">
                            <div class="col-12 text-center">
                                <img *ngIf="dataCustomer" [hidden]="dataCustomer.logotipo === null" [src]="dataCustomer.logotipo" alt="logo"
                                    style="max-height: 80px;" class="text-center rounded-circle">
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-6">
                                <div class="row">
                                    <small class="text-muted text-center">Tipo de Negocio: </small>
                                    <h6 *ngIf="dataCustomer && dataCustomer.type === 0">
                                        <div class="text-center ml-2">  Individual</div>
                                    </h6>
                                    <h6 *ngIf="dataCustomer && dataCustomer.type === 1">
                                        <div class="text-center ml-2"> Juridico</div>
                                    </h6>
                                </div>
                            </div>
                            
                            <div class="col-6">
                                <div class="row">
                                    <small class="text-muted text-center">Tipo de Solicitud: </small>
                                    <h6 *ngIf="lastrequest!=null">
                                        <div class="text-center ml-2">  {{lastrequest.type | req_type }}</div>
                                    </h6>
                                </div>
                            </div>
                        </div>

                        <div class="row mt-2">
                            <div class="col-6">
                                <div class="row">
                                    <small class="text-muted text-center">Tipo de Garantía </small>
                                    <h6 *ngIf="lastrequest!=null">
                                        <div class="text-center ml-2">{{lastrequest.warranty_type | req_warranty_type }}</div>
                                    </h6>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="row">
                                    <small class="text-muted text-center">Tipo de documento </small>
                                    <h6 *ngIf="lastrequest!=null">
                                        <div class="text-center ml-2">{{lastrequest.doc_type | req_doc_type }}</div>
                                    </h6>
                                </div>
                            </div>
                        </div>
                        <div>
                            <hr/>
                        </div>
                        <div class="row mt-2">
                            <div class="col-6">
                                <button class="btn btn-block text-white custom_add1 mb-2" (click)="openModalC1(modalCard1, null)"><i class="fas fa-hand-holding-usd"></i> Monto y Moneda    </button>
                            </div>
                            <div class="col-6">
                                <button class="btn btn-block text-white custom_add1 mb-2" (click)="openModalC1(modalCard2, null)"><i class="fa fa-spinner"></i> Próximamente    </button>
                            </div>
                        </div>
                            
                        
                    </div>
                    <!-- <div class="card-footer text-secondary bg-white" style="padding-block-start: 0%;">
                        <div class="d-flex no-block align-items-center">
                            <h5 *ngIf="lastrequest && lastrequest.status == 0" class="m-b-0">
                                <span class="label label-success m-b-0">Solicitud Creada </span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 1" class="m-b-0">
                                <span class="label label-danger m-b-0">Validando verificaciones</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 2" class="m-b-0">
                                <span class="label label-danger m-b-0">Validando garantías</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 3" class="m-b-0">
                                <span class="label label-danger m-b-0">Enviando formularios</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 4" class="m-b-0">
                                <span class="label label-danger m-b-0">Ingreso de datos a los formularios</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 5" class="m-b-0">
                                <span class="label label-danger m-b-0">Validando formularios</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 6" class="m-b-0">
                                <span class="label label-danger m-b-0">Análisis Legal</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 7" class="m-b-0">
                                <span class="label label-danger m-b-0">Visitas de negocio</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 8" class="m-b-0">
                                <span class="label label-danger m-b-0">Análisis de cumplimiento</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 9" class="m-b-0">
                                <span class="label label-danger m-b-0">Revisión de Expediente</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 10" class="m-b-0">
                                <span class="label label-danger m-b-0">Aprobación Comité Créditos</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 11" class="m-b-0">
                                <span class="label label-danger m-b-0">Envío de informe de negociación</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 12" class="m-b-0">
                                <span class="label label-danger m-b-0">Aprobación Gerencial</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 13" class="m-b-0">
                                <span class="label label-danger m-b-0">Activación de cliente</span>
                            </h5>
                            <h5 *ngIf="lastrequest && lastrequest.status == 14" class="m-b-0">
                                <span class="label label-success m-b-0">Completa</span>
                            </h5>
                            <div class="ml-auto">
                                <h5 class="m-b-0">
                                    
                                </h5>
                            </div>
                        </div>
                    </div> -->
                    
                
                </div>
            </div>
            <ng-template #modalCard1 let-modal>
                <div class="modal-header">
                    <h5 class="modal-title text-center" id="editUserLabel">Editar Monto y Moneda</h5>
                    <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                </div>
                <div class="modal-body"> 
                    <div class="row">
                        <div class="col-lg-12">
                            
                            <form class="form-horizontal" [formGroup]="FormEditCustomer" (ngSubmit)="editCustomer1()">
                                <div class="form-group row col-md-12">
                                    <div class="col-md-2">
                                        <label for="fname" class="text-center control-label col-form-label">Tipo de Usuario: </label>
                                    </div>
                                    <div class="col-md-4">
                                        <p class="text-justify control-label col-form-label font-18">{{dataCustomer.type === 0 ? 'Individual' : 'Jurídico'}}</p>  
                                    </div>
                                    <div class="col-md-2">
                                        <label for="fname" class="text-center control-label col-form-label">Nombre: </label>
                                    </div>
                                    <div class="col-md-4">
                                        <p class="text-justify control-label col-form-label font-18">{{dataCustomer.type === 0 ? dataCustomer.name : dataCustomer.businessname}}</p> 
                                        <small class="form-text text-danger"></small>
                                    </div>
                                </div>
                                <hr>
                                <div class="form-group row col-md-12">
                                    <div class="col-md-2">
                                        <label for="fname" class="text-center control-label col-form-label">Email: </label>
                                    </div>
                                    <div class="col-md-4">
                                        <p class="text-justify control-label col-form-label font-18">{{dataCustomer.email}}
                                        </p>    
                                        <small class="form-text text-danger"></small>
                                    </div>
                                    <div class="col-md-2">
                                        <label for="fname" class="text-center control-label col-form-label">Teléfono: </label>
                                    </div>
                                    <div class="col-md-4">
                                        <p class="text-justify control-label col-form-label font-18">{{dataCustomer.phone === null ? 'Teléfono No Registrado' : dataCustomer.phone}}</p> 
                                    </div>
                                </div>
                                <hr>
                                <div class="form-group row col-md-12">
                                    <div class="col-md-2">
                                        <label for="fname" class="text-center control-label col-form-label">Moneda: </label>          
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group row">
                                            <select class="custom-select" name="currency" id="currency" formControlName="currency">
                                                <option [value]="currency.id_currency" *ngFor="let currency of this.dataCurrency">{{this.currency.currency_name}}</option>
                                            </select>
                                            <small class="form-text text-danger col-sm-12" 
                                            *ngIf="!FormEditCustomer.get('currency').valid && (FormEditCustomer.get('currency').dirty || FormEditCustomer.get('currency').touched)"
                                           >Seleccione la moneda.</small>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <label for="amount_interests" class="text-center control-label col-form-label">Monto Interesado: </label>
                                    </div>
                                    <div class="col-md-4">
                                        <input currencyMask  class="form-control" aria-label="amount_interests" id="amount_interests" formControlName="amount_interests"
                                                 placeholder="Ej. 1000.00" [options]="{ prefix: '', thousands: ',', decimal: '.', nullable:true }">
                                        <p class="text-center text-success control-label col-form-label font-11" *ngIf="dataCustomer.currency === 1">Monto Actual: {{ dataCustomer.amount_interests | currency:'Q ':'code' }}</p>
                                        <p class="text-center text-success control-label col-form-label font-11" *ngIf="dataCustomer.currency === 2">Monto Actual: {{ dataCustomer.amount_interests | currency:'$ ':'code' }}</p>
                                        <p class="text-center text-success control-label col-form-label font-11" *ngIf="dataCustomer.currency > 2">Monto Actual: {{ dataCustomer.amount_interests | currency:' ':'code' }}</p>
                                        <small class="form-text text-danger" *ngIf="!FormEditCustomer.get('amount_interests').valid && (FormEditCustomer.get('amount_interests').dirty || FormEditCustomer.get('amount_interests').touched)">Monto Interesado</small>
                                    </div>
                                </div>
                                <div class="form-group m-b-0 text-right">
                                    <button type="submit" [disabled]="!FormEditCustomer.valid" class="btn btn-raised mr-1 text-white btn-color-solucredit" style="align-items: flex-end;">Guardar Cambios</button>
                                    <button type="submit" class="btn btn-raised mr-1 text-white btn-color-solucredit-secondary" (click)="modal.dismiss('cerrar')">Cancelar</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </ng-template>
            <ng-template #modalCard2 let-modal>
                <div class="modal-header">

                    <h5 class="modal-title text-center" id="editUserLabel">Modal Card 2</h5>
                    <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                </div>

                <div class="modal-body"> 
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card-header" style="background-color: #2061c4;">
                                <h4 class="m-b-0 text-white" style="text-align: center;">Modal Card2</h4>
                            </div>
                            <div class="form-body">

                            </div>
                        </div>
                    </div>
                </div>
            </ng-template>
            <ng-template #modalCard3 let-modal>
                <div class="modal-header">

                    <h5 class="modal-title text-center" id="editUserLabel">Modal Card 3</h5>
                    <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                </div>

                <div class="modal-body"> 
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card-header" style="background-color: #2061c4;">
                                <h4 class="m-b-0 text-white" style="text-align: center;">Modal Card3</h4>
                            </div>
                            <div class="form-body">

                            </div>
                        </div>
                    </div>
                </div>
            </ng-template>
            <ng-template #modalCard4 let-modal>
                <div class="modal-header">

                    <h5 class="modal-title text-center" id="editUserLabel">Modal Card 4</h5>
                    <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
                </div>

                <div class="modal-body"> 
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card-header" style="background-color: #2061c4;">
                                <h4 class="m-b-0 text-white" style="text-align: center;">Modal Card4</h4>
                            </div>
                            <div class="form-body">

                            </div>
                        </div>
                    </div>
                </div>
            </ng-template>

            <!-- <div class="col-md-8 col-12">
                <div class="card-group h-100 text-center">
                    <div class="card">
                        <div class="card-body text-center">
                            <div class="p-2">
                                <h5 *ngIf="dataCustomer && dataCustomer.type === 0"><i class="icon-user customIconH5"></i> Individual</h5>
                                <h5 *ngIf="dataCustomer && dataCustomer.type === 1"><i class="icon-people customIconH5"></i> Jurídico</h5>
                                <h6 class="font-light m-t-10">Tipo de Negocio</h6>
                            </div>
                            <hr>
                            <div class="p-2">
                                <h5><i class="fas fa-hand-holding-usd" (click)="openModalC1(modalCard1, null)"></i> Monto y Moneda</h5>
                                <button *ngIf="canList()" class="btn btn ml-auto h-25 btn-info" (click)="openModalC1(modalCard1, null)">Editar</button>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-body text-center">
                            <div class="p-2">
                                <h5 *ngIf="lastrequest != null && dataCustomer"><i class="icon-notebook customIconH5"></i> {{lastrequest.type | req_type }}</h5>
                                <h5 *ngIf="lastrequest == null && dataCustomer">cargando...</h5>
                                <h6 class="font-light m-t-10">Tipo de Solicitud</h6>
                            </div>
                            <hr>
                            <div class="p-2">
                                <h5><i class="fa fa-spinner"></i>Card2</h5>
                                <button *ngIf="canList()" class="btn btn ml-auto h-25 btn-info" (click)="openModalC1(modalCard2, null)">Próximamente</button>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-body text-center">
                            <div class="p-2">
                                <h5 *ngIf="lastrequest != null && dataCustomer"><i class="icon-graph customIconH5"></i> {{lastrequest.warranty_type | req_warranty_type }}</h5>
                                <h5 *ngIf="lastrequest == null && dataCustomer">Cargando...</h5>
                                <h6 class="font-light m-t-10">Tipo de Garantía</h6>
                            </div>
                            <hr>
                            <div class="p-2">
                                <h5><i class="fa fa-spinner"></i>Card3</h5>
                                <button *ngIf="canList()" class="btn btn ml-auto h-25 btn-info" (click)="openModalC1(modalCard3, null)">Próximamente</button>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-body text-center">
                            <div class="p-2">
                                <h5 *ngIf="lastrequest != null && dataCustomer"><i class="icon-doc customIconH5"></i> {{lastrequest.doc_type | req_doc_type }}</h5>
                                <h5 *ngIf="lastrequest == null && dataCustomer">cargando...</h5>
                                <h6 class="font-light m-t-10">Tipo de Documento</h6>
                            </div>
                            <hr>
                            <div class="p-2">
                                <h5><i class="fa fa-spinner"></i>Card4</h5>
                                <button *ngIf="canList()" class="btn btn ml-auto h-25 btn-info" (click)="openModalC1(modalCard4, null)">Próximamente</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->
            <div class="col-md-8 col-12">
                <app-directive class='alert-custom-normal' *ngIf="requestIdSelected>0&&dataCustomer" [request_id]="requestIdSelected"
                    [customer_type]="dataCustomer.type"
                    [spinner]="this.spinner"
                    (blockComponent)="changeBlockTab1()" (showViews)="getShowViews($event)" [userID]="user_id">
                </app-directive>
            </div>
       
        </div>
        <br>
      
        <div class="card-body mt-4" style="background-color:#2061c4; color:white; height: 40px; padding-top: 12px;text-align: center;">
            <h5 class="card-title">ANÁLISIS DE REQUISITOS</h5>
        </div>
        <div class="card">
            <div class="card-body pl-0 pr-0 pt-0" *ngIf="requestSelected">
                <ngb-tabset type="pills" [justify]="currentJustify" (NgbTabChangeEvent)="TabChange($event)" #ctdTabset="ngbTabset"> 

                    

                    <ngb-tab *ngIf=" usersolucredit && requestSelected " (NgbTabChangeEvent)="TabChange($event)" [id]='TabConfigurations' [disabled]="disabledTabConfigurations">
                        <ng-template ngbTabTitle>
                            <div [ngClass]="getAllAvalsCheck()?'my-tab':''">
                                <b>CONFIGURACIONES</b>
                                <span *ngIf="getAllAvalsCheck()" style="font-size: 2x; color: Dodgerblue; margin-left: 10px; color:white">
                                    <i class="fas fa-check"></i>
                                </span>
                            </div>
                        </ng-template>
                        <ng-template ngbTabContent>
                            <div class="main-part" *ngIf="disableView(TabConfigurations)">
                                <app-access-denied-page></app-access-denied-page>
                            </div>
                            <div class="main-part " *ngIf="!disableView(TabConfigurations)">
                                
                                <div class="left-part bg-white overflow-auto fixed-left-part " [ngClass]="{ 'show-panel': showSidebar} ">

                                    <div class="position-relative">

                                        <div>
                                            <div class="notes-list " *ngIf="requestAvalsInfo.length> 0; else elseBlock">
                                                <div *ngFor='let aval of requestAvalsInfo;' class="notes-item" (click)="onSelectAval(aval);" [class.selected]="aval === currentAval">
                                                    <div class="d-flex py-3 border-bottom pr-3 position-relative">
                                                        <div>
                                                            <span class="note-color bg-info"></span>
                                                            <span class="note-title text-truncate">{{aval.name}}</span>
                                                            <small class="note-time">Personas: {{aval.subjects.length}}</small>
                                                        </div>
                                                        <!--  <span (click)="removeAval(aval)" class="ml-auto remove-note">x</span> -->
                                                    </div>
                                                </div>
                                            </div>
                                            <ng-template #elseBlock>
                                                <p class="mb-0 text-center font-18 font-bold mt-5">Ningun Aval Encontrado...</p>
                                            </ng-template>
                                        </div>
                                    </div>
                                </div>
                                <div class="right-part bg-white overflow-auto">
                                    <div class="card p-4">

                                        <div class="bg-white">
                                            <div *ngIf="currentAval != null">
                                                <div *ngIf="currentAval.requirements!=undefined &&currentAval.requirements.update_date!=null" class="mb-3">
                                                    <h5 class="note-title my-auto font-medium">Última Actualización:</h5>
                                                    <span class="note-title-large my-auto mx-auto">{{currentAval.requirements.update_date|date:'fullDate':'es-Gt'}}, {{currentAval.requirements.update_date|date:'h:mm a'}}</span>
                                                </div>
                                                <button *ngIf="currentAval.requirements" [ngClass]="currentAval.requirements.update_date!=null?'btn-success':'btn-avals-from'" class="btn ml-3 mb-3 text-white" (click)="EditRequisitos(requirementConfigModal,currentAval)" style="margin-right: 1rem;">Ver requisitos</button>
                                                <div class="table-responsive">
                                                    <table class="table table-hover mb-0 no-wrap v-middle ">
                                                        <thead>
                                                            <tr>
                                                                <th scope="col" style="text-align: center;">#</th>
                                                                <th scope="col" style="text-align: center;">Nombre</th>
                                                                <th scope="col" style="text-align: center;">Télefono</th>
                                                                <th scope="col" style="text-align: center;">Correo</th>
                                                                
                                                                <th scope="col" style="text-align: center;">Acciones</th>

                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr class="table-hover " *ngFor="let subject of currentAval.subjects;let j = index">
                                                                <td scope="col" style="text-align: center;">
                                                                    {{j+1}}
                                                                </td>
                                                                <td scope="col" style="text-align: center;">{{getSubjectName(subject)}}</td>
                                                                <td scope="col" style="text-align: center;">{{subject.phone  === !null ? subject.phone : 'No registrado'}}</td>
                                                                <td scope="col" style="text-align: center;">{{subject.email === !null ? subject.email : 'No registrado'}}</td>
                                                               

                                                                <td scope="col" style="text-align: center;">
                                                                    <button [ngClass]="subject.requirements_update_date!=null?'btn-success':'btn-avals-from'" class="btn mb-2 text-white " (click)="EditForms(subject,formsModal)">Ir a checklist formularios</button>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </ngb-tab>
                    <ngb-tab *ngIf="usersolucredit && requestSelected" (NgbTabChangeEvent)="TabChange($event)" [id]='TabVerifications' [disabled]="disabledTabVerifications">
                        <ng-template ngbTabTitle>
                            <div [ngClass]="contVerifications==5?' my-tab':''">
                                <b>VERIFICACIONES {{contVerifications}} de 5</b>
                                    <span *ngIf="contVerifications==5" style="font-size: 2x; color: Dodgerblue; margin-left: 10px; color:white">
                                        <i class="fas fa-check"></i>
                                    </span>
                            </div>
                        </ng-template>
                        <ng-template ngbTabContent>
                            <!-- ALERT FORMS COMPLETED -->
                            <div class="main-part" *ngIf="disableView(TabVerifications)">
                                <app-access-denied-page></app-access-denied-page>
                            </div>
                            <div *ngIf="!disableView(TabVerifications)" >
                                <ngb-alert *ngIf="StatusRecordCrediticio.check ||StatusGuatecompras.check &&  StatusInfornet.check && StatusSat.check && StatusDeclaraguate.check && StatusVisitasInicial.check" type="custom" [dismissible]="false" >
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="input-group col-sm-12 " style="align-items: center;">
                                                <span style="color: #47D764; margin-right: 5;">
                                                    <i class="fas fa-check-circle fa-2x" ></i>
                                                </span>
                                                <h4 style="margin-left: 50px;">!Las verificaciónes han sido marcados como aprobados!</h4>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div style="display: flex; align-items: flex-end; justify-content: flex-end; ">
                                                <button *ngIf="canCompleteChecks()" [hidden]="statusbtnVerificaciones.value === 0" [class]="statusbtnVerificaciones.class" class="btn text-white" (click)="openModalSolicitud(this.cambiarestadosol,'verificaciones',statusbtnVerificaciones.value)">
                                                    <i [class]="statusbtnVerificaciones.icon"></i> {{statusbtnVerificaciones.text}} </button>
    
                                                <button *ngIf="canRejectChecks()" [hidden]="statusbtnVerificaciones.value === 0" class="btn text-white btn-danger" (click)="openModalSolicitud(this.cambiarestadosol,'verificaciones',2)">
                                                            <i class="icon-close"></i> Rechazar Verificaciones </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row" *ngIf="statusbtnVerificaciones.value === 0" style="margin-top: 10px;">
                                        <br>
                                        <div class="col-lg-6">
                                            <h5>
                                                <strong>Autorizado por:</strong>
                                                {{verificationsSubject}}
                                            </h5>
                                        </div>
                                    </div>
                                    <div class="row" *ngIf="statusbtnVerificaciones.value === 0 " style="margin-top: 10px;">
                                        <br>
                                        <div class="col-lg-6">
                                            <h5>
                                                <strong>Fecha:</strong>
                                                    {{getVerificationsInfo('Verificaciones aceptadas')!=null?(getVerificationsInfo('Verificaciones aceptadas').date|date:'MMM d, y, h:mm a'):''}}
                                            </h5>
                                        </div>
                                    </div>
                                </ngb-alert>
                                <div class="row m-t-30 pl-2 pr-2 ml-2 mr-2 p-b-2" style="background: #fff;">
                                    <div class="table-responsive ">
                                        <table class="table table-hover mb-0 no-wrap v-middle">
                                            <thead>
                                                <tr>
                                                    <th scope="col" style="text-align: center;">Nombre de la Verificación</th>
                                                    <th scope="col" style="text-align: center;">Estado</th>
                                                    <th scope="col" style="text-align: center;">Subir Archivos</th>
                                                    <th scope="col" style="text-align: center;">Archivos</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Visita inicial</td>
                                                    <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                                        <ngx-spinner name="cs17" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                            <p style="color: white"> Cambiando Estatus ... </p>
                                                        </ngx-spinner>
                                                        <ng-container *ngIf="canCompleteChecks()">
                                                            <div class="form-check form-check-inline" [hidden]="!usersolucredit" *ngIf="contvisitainicial > 0">
                                                                <input class="form-check-input" [checked]="StatusVisitasInicial.check" type="checkbox" id="checkboxSolicitud" value="VisitasInicial" (change)="onCheckboxChange($event,'verificaciones','visitasinicial','cs17')">
                                                                <label class="form-check-label" for="checkboxSolicitud">Completar Verificación</label>
                                                            </div>
                                                        </ng-container>
    
                                                        <span [ngClass]="StatusVisitasInicial.class" class="label  font-weight-100">{{StatusVisitasInicial.status}}</span>
                                                    </td>
                                                    <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                                        <ngx-spinner name="s17" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                            <p style="color: white"> Subiendo Documento ... </p>
                                                        </ngx-spinner>
                                                        <button class="btn text-white custom_add1" (click)="OpenVisita(visitainicial)">Información de la visita</button>
                                                    </td>
                                                    <td>
                                                        <!-- //Fachada 0 //Recepcion1 // Interior2-->
                                                        <!-- //Obtener todos los lugares -->
                                                        <div *ngFor="let place of dataInspectionPlace">
                                                            <tr class="text-center" >
                                                                <th colspan="3">
                                                                    <h6 class="mb-0">{{place.name_place}}</h6>
                                                                </th>
                                                                <div *ngFor="let item of verificationsCustomer">
                                                                    <tr *ngIf="item.name === 'visitasinicial' && item.type === place.id_place">
                                                                        <td [ngbTooltip]="item.document_name|namefile">{{item.document_name|namefile | slice:0:8}}...</td>
                                                                        <td><i style="cursor: pointer;" class=" icon-eye" (click)="ViewDocu(viewdocuments,'verificaciones',item.document_name)"></i></td>
                                                                        <td><i style="cursor: pointer;color:red" (click)="DeleteDocu('verificaciones',item.document_name)" class="icon-trash"></i></td>
                                                                    </tr>
                                                                </div>
                                                            </tr>
                                                        </div>
                                                            
                                                        
                                                    </td>
                                                </tr>
                                               
                                                <tr>
                                                    <td>Guatecompras <a target="blank_" [href]="getLink('GUATECOMPRAS')">(Visitar Sitio)</a></td>
                                                    <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                                        <ngx-spinner name="cs19" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                            <p style="color: white"> Cambiando Estatus ... </p>
                                                        </ngx-spinner>
                                                        <ng-container *ngIf="canCompleteChecks()">
                                                            <div class="form-check form-check-inline" [hidden]="!usersolucredit" *ngIf="contguatecompras > 0">
                                                                <input class="form-check-input" [checked]="StatusGuatecompras.check" type="checkbox" id="checkboxGuate" value="Guatecompras" (change)="onCheckboxChange($event,'verificaciones','guatecompras','cs19')">
                                                                <label class="form-check-label" for="checkboxGuate">Completar Verificación</label>
                                                            </div>
                                                        </ng-container>
    
                                                        <span [ngClass]="StatusGuatecompras.class" class="label  font-weight-100">{{StatusGuatecompras.status}}</span>
                                                    </td>
                                                    <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                                        <ngx-spinner name="s19" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                            <p style="color: white"> Subiendo Documento ... </p>
                                                        </ngx-spinner>
                                                        <fieldset class="form-group">
                                                            <input type="file" class="" id="exampleInputFile" (change)="showPreviewImage($event,'verificaciones','guatecompras','s19')">
                                                        </fieldset>
                                                    </td>
                                                    <td>
                                                        <div *ngFor="let item of verificationsCustomer">
                                                            <tr *ngIf="item.name === 'guatecompras'">
                                                                <td [ngbTooltip]="item.document_name|namefile">{{item.document_name |namefile|slice:0:8}}...</td>
                                                                <td><i style="cursor: pointer;" class=" icon-eye" (click)="ViewDocu(viewdocuments,'verificaciones',item.document_name)"></i></td>
                                                                <td><i style="cursor: pointer;color:red" (click)="DeleteDocu('verificaciones',item.document_name)" class="icon-trash"></i></td>
                                                            </tr>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>INFORNET <a target="blank_" [href]="getLink('INFORNET')">(Visitar Sitio)</a></td>
                                                    <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                                        <ngx-spinner name="cs20" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                            <p style="color: white"> Cambiando Estatus ... </p>
                                                        </ngx-spinner>
                                                        <ng-container *ngIf="canCompleteChecks()">
                                                            <div class="form-check form-check-inline" [hidden]="!usersolucredit" *ngIf="continfornet > 0">
                                                                <input class="form-check-input" [checked]="StatusInfornet.check" type="checkbox" id="checkboxInfor" value="Infornet" (change)="onCheckboxChange($event,'verificaciones','infornet','cs20')">
                                                                <label class="form-check-label" for="checkboxInfor">Completar Verificación</label>
                                                            </div>
                                                        </ng-container>
    
                                                        <span [ngClass]="StatusInfornet.class" class="label  font-weight-100">{{StatusInfornet.status}}</span>
                                                    </td>
                                                    <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                                        <ngx-spinner name="s20" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                            <p style="color: white"> Subiendo Documento ... </p>
                                                        </ngx-spinner>
                                                        <fieldset class="form-group">
                                                            <input type="file" class="" id="exampleInputFile" (change)="showPreviewImage($event,'verificaciones','infornet','s20')">
                                                        </fieldset>
                                                    </td>
                                                    <td>
                                                        <div *ngFor="let item of verificationsCustomer">
                                                            <tr *ngIf="item.name === 'infornet'">
                                                                <td [ngbTooltip]="item.document_name|namefile">{{item.document_name|namefile | slice:0:8}}...</td>
                                                                <td><i style="cursor: pointer;" class=" icon-eye" (click)="ViewDocu(viewdocuments,'verificaciones',item.document_name)"></i></td>
                                                                <td><i style="cursor: pointer;color:red" (click)="DeleteDocu('verificaciones',item.document_name)" class="icon-trash"></i></td>
                                                            </tr>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>SAT <a target="blank_" [href]="getLink('SAT')">(Visitar Sitio)</a></td>
                                                    <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                                        <ngx-spinner name="cs21" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                            <p style="color: white"> Cambiando Estatus ... </p>
                                                        </ngx-spinner>
                                                        <ng-container *ngIf="canCompleteChecks()">
                                                            <div class="form-check form-check-inline" [hidden]="!usersolucredit" *ngIf="contsat > 0">
                                                                <input class="form-check-input" [checked]="StatusSat.check" type="checkbox" id="checkboxCompleto" value="Sat" (change)="onCheckboxChange($event,'verificaciones','sat','cs21')">
                                                                <label class="form-check-label" for="checkboxCompleto">Completar Verificación</label>
                                                            </div>
                                                        </ng-container>
    
                                                        <span [ngClass]="StatusSat.class" class="label  font-weight-100">{{StatusSat.status}}</span>
                                                    </td>
                                                    <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                                        <ngx-spinner name="s21" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                            <p style="color: white"> Subiendo Documento ... </p>
                                                        </ngx-spinner>
                                                        <fieldset class="form-group">
                                                            <input type="file" class="" id="exampleInputFile" (change)="showPreviewImage($event,'verificaciones','sat','s21')">
                                                        </fieldset>
                                                    </td>
                                                    <td>
                                                        <div *ngFor="let item of verificationsCustomer">
                                                            <tr *ngIf="item.name === 'sat'">
                                                                <td [ngbTooltip]="item.document_name|namefile">{{item.document_name|namefile | slice:0:8}}...</td>
                                                                <td><i style="cursor: pointer;" class=" icon-eye" (click)="ViewDocu(viewdocuments,'verificaciones',item.document_name)"></i></td>
                                                                <td><i style="cursor: pointer;color:red" (click)="DeleteDocu('verificaciones',item.document_name)" class="icon-trash"></i></td>
                                                            </tr>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>DECLARAGUATE <a target="blank_" [href]="getLink('DECLARAGUATE')">(Visitar Sitio)</a></td>
                                                    <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                                        <ngx-spinner name="cs22" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                            <p style="color: white"> Cambiando Estatus ... </p>
                                                        </ngx-spinner>
                                                        <ng-container *ngIf="canCompleteChecks()">
                                                            <div class="form-check form-check-inline" [hidden]="!usersolucredit" *ngIf="contdeclaraguate > 0">
                                                                <input class="form-check-input" [checked]="StatusDeclaraguate.check" type="checkbox" id="checkboxCompletodec" value="Declaraguate" (change)="onCheckboxChange($event,'verificaciones','declaraguate','cs22')">
                                                                <label class="form-check-label" for="checkboxCompletodec">Completar Verificación</label>
                                                            </div>
                                                        </ng-container>
    
                                                        <span [ngClass]="StatusDeclaraguate.class" class="label  font-weight-100">{{StatusDeclaraguate.status}}</span>
                                                    </td>
                                                    <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                                        <ngx-spinner name="s22" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                            <p style="color: white"> Subiendo Documento ... </p>
                                                        </ngx-spinner>
                                                        <fieldset class="form-group">
                                                            <input type="file" class="" id="exampleInputFile" (change)="showPreviewImage($event,'verificaciones','declaraguate','s22')">
                                                        </fieldset>
                                                    </td>
                                                    <td>
                                                        <div *ngFor="let item of verificationsCustomer">
                                                            <tr *ngIf="item.name === 'declaraguate'">
                                                                <td [ngbTooltip]="item.document_name|namefile">{{item.document_name|namefile | slice:0:8}}...</td>
                                                                <td><i style="cursor: pointer;" class=" icon-eye" (click)="ViewDocu(viewdocuments,'verificaciones',item.document_name)"></i></td>
                                                                <td><i style="cursor: pointer;color:red" (click)="DeleteDocu('verificaciones',item.document_name)" class="icon-trash"></i></td>
                                                            </tr>
                                                        </div>
                                                    </td>
                                                </tr>
                                              
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                        </ng-template>
                    </ngb-tab>
                    <ngb-tab (NgbTabChangeEvent)="TabChange($event)" [id]='TabForms' [disabled]="disabledTabForms">
                        <ng-template ngbTabTitle (click)="resetAval()">
                            <div [ngClass]="statusbtnFormularios.value===0?'my-tab':''">
                                <b>FORMULARIOS</b>
                                <span *ngIf="statusbtnFormularios.value===0" style="font-size: 2x; color: Dodgerblue; margin-left: 10px; color:white">
                                    <i class="fas fa-check"></i>
                                </span>
                            </div>
                        </ng-template>
                        <ng-template ngbTabContent>
                            <div class="main-part" *ngIf="disableView(TabForms)">
                                <app-access-denied-page></app-access-denied-page>
                            </div>
                            <div class="card-img-overlay" style="position: relative;" *ngIf="!disableView(TabForms)">
                                <!-- ALERT FORMS COMPLETED -->
                                <ngb-alert *ngIf="isAllSubjectComplete()" type="custom" [dismissible]="false" >
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="input-group col-sm-12 " style="align-items: center;">
                                                <span style="color: #47D764; margin-right: 5;">
                                                    <i class="fas fa-check-circle fa-2x" ></i>
                                                </span>
                                                <h4 style="margin-left: 50px;">!Los formularios y los requisitos han sido marcados como aprobados!</h4>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div style="display: flex; align-items: flex-end; justify-content: flex-end; ">
                                                <button *ngIf="canCompleteForms()" [class]="statusbtnFormularios.class " class="btn text-white " (click)="openModalSolicitud(this.cambiarestadosol, 'formulario',statusbtnFormularios.value) "> {{statusbtnFormularios.text}} </button>

                                                <button *ngIf="canRejectForms()" class="btn text-white btn-danger " (click)="openModalSolicitud(this.cambiarestadosol, 'formulario',2) ">
                                                                Rechazar Formularios </button>

                                               <!--  <span *ngIf="statusbtnFormularios.value===0 " _ngcontent-wdw-c139=" " class="label font-weight-100 label-success " ng-reflect-ng-class="label-success ">Aprobado</span> -->
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row" *ngIf="statusbtnFormularios.value === 0" style="margin-top: 10px;">
                                        <br>
                                        <div class="col-lg-6">
                                            <h5>
                                                <strong>Autorizado por:</strong>
                                                {{formsSubject}}
                                            </h5>
                                        </div>
                                    </div>
                                    <div class="row" *ngIf="statusbtnFormularios.value === 0" style="margin-top: 10px;">
                                        <br>
                                        <div class="col-lg-6">
                                            <h5>
                                                <strong>Fecha:</strong>
                                                    {{getVerificationsInfo('Formularios aceptados')!=null?(getVerificationsInfo('Formularios aceptados').date|date:'MMM d, y, h:mm a'):''}}
                                            </h5>
                                        </div>
                                    </div>
                                    
                                </ngb-alert>
                                <!-- END ALERT -->
                                <div class="row">
                                    <div class="col-12">
                                        <div class="row" *ngIf="subjectsList.length> 0; else subjectsElseBlock">
                                            <div class="col-lg-12 pb-2" *ngFor='let subject of groupSubjectsList(subjectsList);let i=index;'>
                                                <!-- REQUIREMENTS -->
                                                <div class="solucredit-secondary-card card" *ngIf="subject.rsdet_id == null" style="margin-bottom: 0px !important;">
                                                    <div class="card-body">
                                                        <div class="row">
                                                            <div class="col-lg-6">
                                                                <div class="d-flex d-inline-flex flex-row">
                                                                    <!-- <div class="d-inline my-auto ">
                                                                        <h3>
                                                                        <i class="fa fa-check text-success"></i>
                                                                        <i class="fa fa-times text-warning" *ngIf="person.DPI_key == null || person.letter_of_consent_key == null"></i>
                                                                        </h3>
                                                                    </div> -->
                                                                    <div class="d-inline my-auto ml-4">
                                                                        <img src="assets/images/user.png" alt="user" width="50" class="rounded-circle">
                                                                    </div>
                                                                    <h5 class="d-inline my-auto ml-3 font-medium">{{subject.subject_name}}</h5>

                                                                    <h6 *ngIf="haveRequirements(subject.rwedet_id)" class="d-inline my-auto ml-4">Requisitos: {{getRequisitosInfo(subject.rwedet_id)}}</h6>
                                                                    
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-3 my-auto">
                                                                <div class="d-flex d-inline-flex flex-row">
                                                                    <div class="d-inline my-auto">
                                                                        <span *ngIf="haveRequirements(subject.rwedet_id)" class="d-inline my-auto label font-weight-100" [ngClass]="getRequisitosStateClass(subject.rwedet_id)">{{getRequistosStateText(subject.rwedet_id)}}</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-3 text-right my-auto">
                                                                <div class="ml-auto text-right my-auto" *ngIf="haveRequirements(subject.rwedet_id)">
                                                                    <div class="d-flex flex-row-reverse align-items-center border-left custom-card-list-link" (click)="OpenRequirements(subject.rwedet_id,requirementModal)">
                                                                        <i class="display-6 icon-arrow-right ml-3"></i>
                                                                        <h4 class="ml-3 my-auto">
                                                                            VER REQUISITOS 
                                                                        </h4>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- FORMS -->
                                                <ul class="timeline timeline-left" *ngIf="subject.childs.length > 0" style="margin-left: 7rem !important;">
                                                    <li class="timeline-inverted timeline-item" *ngFor="let child of subject.childs">
                                                        <div class="timeline-badge text-white">
                                                            <img width="50" class="img-fluid" src="assets/images/user.png" />
                                                        </div>
                                                        <div class="timeline-panel solucredit-base-card" style="border-radius: 10px !important;">
                                                            <div class="timeline-body">
                                                                <div class="row">
                                                                    <div class="col-lg-6 my-auto">
                                                                        <div class="d-flex justify-content-between flex-row">
                                                                            <h5 class="d-inline my-auto font-medium">{{getSubjectName(child)}}</h5>
                                                                            <h6 class="d-inline my-auto">{{child.subject_name.toUpperCase()}}</h6>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-3 my-auto">
                                                                        <div class="d-flex d-inline-flex flex-row">
                                                                            <div class="d-inline my-auto">
                                                                                <button *ngIf="!checkForComplete(child) && (child.complete_status == 0 || child.complete_status == null)" class="btn custom_btn2" ngbTooltip="Marcar como aprobado" (click)="onSelectSubject(child); completeSubjectForms(child)">
                                                                                    <i class="fa text-warning fa-times"></i> 
                                                                                    Aprobar
                                                                                </button>
                                                                            </div>
                                                                            <div class="d-inline my-auto">
                                                                                <button class="btn custom_btn2" *ngIf="(child.complete_status != 0 && child.complete_status != null) && !checkForComplete(child)" (click)="onSelectSubject(child); incompleteSubjectForms(child)" ngbTooltip="Marcar como no aprobado">
                                                                                    <i class="fa text-success fa-check"></i> 
                                                                                    Aprobado
                                                                                </button>
                                                                            </div>
                                                                            <span [ngClass]="child.complete_status == 0 || child.complete_status == null ? 'label-warning':'label-success'" class="d-inline my-auto label font-weight-100">
                                                                                {{child.complete_status == 0 || child.complete_status == null? 'No aprobado' : 'Aprobado'}}
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-lg-3 text-right my-auto">
                                                                        <div class="ml-auto text-right my-auto">
                                                                            <div class="d-flex flex-row-reverse align-items-center border-left custom-card-list-link" (click)="onSelectSubject(child); openUserFormsListModal(userFormsList, child.subject_name)">
                                                                                <i class="display-6 icon-arrow-right ml-3"></i>
                                                                                <h4 class="ml-3 my-auto">
                                                                                    VER FORMULARIOS
                                                                                </h4>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </li>
                                                </ul>

                                              
                                            </div>
                                        </div>
                                        <ng-template #subjectsElseBlock>
                                            <div class="row">
                                                <div class="col-12">
                                                    <p class="mb-0 text-center font-10 font-bold mt-5">Ningun subject encontrado..</p>
                                                </div>
                                            </div>
                                        </ng-template>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                    </ngb-tab>
                    <ngb-tab (NgbTabChangeEvent)="TabChange($event)" [id]='TabAuthorization' [disabled]="disabledTabAuthorizations">
                        <ng-template ngbTabTitle><b>AUTORIZACIONES</b></ng-template>
                        <ng-template ngbTabContent>
                            <app-analysis-tab 
                            [showViews]="showViews" 
                            [requestIdSelected]="requestIdSelected" 
                            [dataCustomer]="dataCustomer"
                            [default_views]="default_views"
                            [document_serie_id]="document_serie_id"
                            [lastRequest]="lastrequest" 
                            [requestAvalsInfo]="requestAvalsInfo"
                            [groupSubjectList]="groupSubjectsList(this.subjectsList)"
                            ></app-analysis-tab>
                        </ng-template>
                    </ngb-tab>
                </ngb-tabset>
            </div>
        </div>
    </div>
</div>
<ng-template #requirementObservation let-modal>
    <div class="modal-header">
        <h3 class="modal-title" id="editUserLabel">Observaciones</h3>
        <button type="button" class="close" (click)="closeEditDataMod(modal)" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <form class="form-horizontal" [formGroup]="requirementObservationForm" (ngSubmit)="createObservation()">
            <div class="form-group row">
                <label for="email" class="col-sm-2 text-right control-label col-form-label">Nombre:</label>
                <div class="col-sm-9 ">
                    <div class="input-group col-sm-12 ">
                        <div class="input-group-prepend ">
                            <span class="input-group-text " id="basic-addon1">
                                <i class="fas fa-book"></i>
                            </span>
                        </div>
                        <input type="text" class="form-control " formControlName="title" required
                            placeholder="Ingresar Título">
                    </div>
                </div>
            </div>
            <div class="form-group row">
                <label for="email" class="col-sm-2 text-right control-label col-form-label">Descripción:</label>
                <div class="col-sm-9 ">
                    <div class="input-group col-sm-12 ">
                        <div class="input-group-prepend ">
                            <span class="input-group-text " id="basic-addon1">
                                <i class="fas fa-comment"></i>
                            </span>
                        </div>
                        <textarea class="form-control " formControlName="comment" required rows="12"
                            placeholder="Ingresar Descripción"></textarea>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-top-0">
                <button type="submit" class="btn btn-raised mr-1 text-white" [disabled]="!requirementObservationForm.valid"
                    style="background-color: #3473da;">Actualizar</button>
                <button type="button" class="btn btn-raised mr-1 text-white  btn-color-solucredit-secondary"
                    (click)="closeBtnClick()">Cancelar</button>
            </div>
        </form>
    </div>
</ng-template>

<ng-template #ChooseDownloadModal let-modal>
    <div class="modal-header">
        <h3 class="modal-title" id="editUserLabel">Descarga de documentos</h3>
        <button type="button" class="close" (click)="closeEditDataMod(modal)" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-12">
                <div class="table-responsive table-hover">

                    <table class="table table-responsive-lg no-wrap v-middle white-table">
                        <thead>
                            <tr>
                                <th>
                                    <div class="text-center">
                                        #
                                    </div>
                                </th>
                                <th>
                                    <div class="text-center">
                                        Nombre
                                    </div>
                                </th>
                                <th>
                                    <div class="text-center">
                                        Acciones
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    1
                                </td>
                                <td>
                                    Documentación Inicial
                                </td>
                                <td style=" justify-content: center; align-items: center;">
                                    <div class="div-table-actions" style="justify-content: center; z-index: 1;">
                                        <button type="button" (click)="downloadDocIR()"
                                            class="btn btn-raised mr-1 text-white"
                                            style="background-color: #3473da;">Descargar</button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    2
                                </td>
                                <td>
                                    Requisitos
                                </td>
                                <td style=" justify-content: center; align-items: center;">
                                    <div class="div-table-actions" style="justify-content: center; z-index: 1;">
                                        <button type="button" (click)="downloadDocRequirements()"
                                            class="btn btn-raised mr-1 text-white"
                                            style="background-color: #3473da;">Descargar</button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    3
                                </td>
                                <td>
                                    Formularios
                                </td>
                                <td style=" justify-content: center; align-items: center;">
                                    <div class="div-table-actions" style="justify-content: center; z-index: 1;">
                                        <button type="button" (click)="downloadDocForms()"
                                            class="btn btn-raised mr-1 text-white"
                                            style="background-color: #3473da;">Descargar</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #requirementModal let-modal>
    <div class="modal-header">

        <h3 class="modal-title" id="editUserLabel">Requisitos</h3>

        <button type="button" class="close" (click)="closeEditDataMod(modal)" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>

    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-12">
                <ngx-spinner [name]="'spnn'" bdColor="rgba(0, 0, 0, 0.8) " size="medium " color="#759ee0 " type="ball-atom " [fullScreen]="false ">
                    <p style="color: white "> Cambiando Estatus ... </p>
                </ngx-spinner>
                <div class="">
                    <div class="table-responsive" style="height: 50vh;">
                        <table class="table table-hover" >
                            <thead> 
                                <tr style="background-color: white;">
                                    <th>#</th>
                                    <th style="background-color: white; z-index: 2;" scope="col">Nombre del requisito</th>
                                    <th style="background-color: white; z-index: 2;" scope="col">Aprobación</th>
                                    <th style="background-color: white; z-index: 2;" scope="col">Observaciones</th>
                                    <th style="background-color: white; z-index: 2;" scope="col">Subir archivos</th>
                                    <th style="background-color: white; z-index: 2;" scope="col">Archivos</th>
                                    <!-- <th scope="col">Acciones</th> -->
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let req of currentAval.requirements.requirements|req_disable_reqs; let i = index">
                                    <td width="50" class="text-center">{{i+1}}</td>
                                    <td class="ticket-desc">
                                        <p [ngbTooltip]="req.req_name" class="mb-1">
                                            <!--  <ngb-highlight [result]="ticket.ticketTitle" [term]="searchTerm"></ngb-highlight> -->
                                            {{req.req_name}}
                                        </p>
                                        <small class="text-truncate"> {{req.req_type|req_requirements_type}}</small>
                                    </td>
                                    <td class="text-center" width="150">
                                        <ngx-spinner [name]="'cs'+ i" bdColor="rgba(0, 0, 0, 0.8) " size="medium " color="#759ee0 " type="ball-atom " [fullScreen]="false ">
                                            <p style="color: white "> Cambiando Estatus ... </p>
                                        </ngx-spinner>
                                        <!-- *ngIf="canCompleteForms()" -->
                                        <ng-container *ngIf="canCompleteForms()">
                                            <div class="form-check form-check-inline ">
                                                <!-- <input type="checkbox" [(ngModel)]="formsCheckBoxesData[i].value" (change)="changeRequirementAprovStatus($event,req,'cs'+i)"> -->
                                                <!-- <input class="form-check-input" [checked]="StatusSolicitud.check" type="checkbox" id="checkboxSolicitud" value="Solicitud" (change)="onCheckboxChange($event,'formularios','solicitud','cs'+i)"> -->
                                                <input [(ngModel)]="formReqsCheckBoxesData[i].value" type="checkbox" (change)="updateRequisitosStatus('cs'+i)" [disabled]="isDPI(req.req_name)">
                                                <label class="form-check-label" for="checkboxSolicitud">Aprobar</label>
                                            </div>
                                        </ng-container><br/>
                                        <span [ngClass]="req.state == 0?'label label-warning':'label label-success'">{{ req.state == 0?'No aprobado':'Aprobado' }}</span>
                                    </td>
                                    <td>
                                        <button class="btn  text-white custom_add1 mb-2"
                                        (click)="openRequirementObservationModal(req,requirementObservation)"
                                        >
                                            <i class="fas fa-edit"></i>
                                            Observación
                                        </button>
                                    </td>
                                    <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                        <ngx-spinner [name]="'s'+i" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                            <p style="color: white"> Subiendo Documento ... </p>
                                        </ngx-spinner>
                                        <fieldset class="form-group">
                                            <input type="file" class="" (change)="uploadReq($event,req,'s'+i)" [disabled]="isDPI(req.req_name)">
                                        </fieldset>
                                    </td>

                                    <td>
                                        <div *ngFor="let doc of req.docs">
                                            <div class="row">
                                                <td [ngbTooltip]="doc.name">{{doc.name.length>15?(doc.name|slice:0:15)+"...":doc.name}}...</td>
                                                <td *ngIf="doc.is_visible == 1"><i style="cursor: pointer;" class="icon-eye" (click)="ViewReqDoc(viewdocumentsclose,doc)"></i></td>
                                                <td><i style="cursor: pointer;" class="icon-cloud-download" (click)="DownloadReqDoc(doc)"></i></td>
                                                <td><i style="cursor: pointer;color:red" (click)="DeleteReqDoc(req,doc)" class="icon-trash"></i></td>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
                <div style="display: flex; align-items: flex-end; justify-content: flex-end; margin-top: 0.5rem;">
                    <button *ngIf="isRequirementsComplete() && (this.currentAval.requirements.state == 0 || this.currentAval.requirements.state == null)" class="btn text-white custom_add1 ml-2 mt-4" (click)="updateRequisitosComplete('spnn')">
                    <i class="icon-check pr-2"></i>Completar requisitos </button>

                    <button class="btn text-white btn-color-solucredit-secondary mt-4 ml-2" (click)="closeEditDataMod(modal)">
                    <i class="icon-close"></i> Cancelar </button>

                </div>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #requirementConfigModal let-modal>
    <div class="modal-header">

        <h3 class="modal-title" id="editUserLabel">Requerimientos de {{this.nametmp | capitalize}}</h3>

        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>

    </div>
    <div class="modal-body">
        <div class="row">
        <div class="col-12">
                <ngx-spinner #spreqconf [name]="spreqconf" bdColor="rgba(0, 0, 0, 0.8) " size="medium " color="#759ee0 "
                    type="ball-atom " [fullScreen]="false ">
                    <p style="color: white "> Cambiando Estatus ... </p>
                </ngx-spinner>
                <div class="">

                    <div class="table-responsive " style="height:50vh">
                        <table class="table table-hover">
                            <thead>
                                <tr>
                                    <th style="width: 100px;">#</th>
                                    <th class="col-8" style="background-color: white; z-index: 2;" >Nombre del requisito</th>
                                   <!--  <th class="col-3">Requerido</th> -->
                                    <th style="position: sticky;" style="background-color: white; z-index: 2;" scope="col">
                                        <div style="display: flex; flex-direction: column;">
                                            Requerido
                                        <ng-container>
                                            <div class="form-check form-check-inline ">
                                                <input type="checkbox" (change)="changeAllRequirements()">
                                                <!-- <input class="form-check-input" [checked]="StatusSolicitud.check" type="checkbox" id="checkboxSolicitud" value="Solicitud" (change)="onCheckboxChange($event,'formularios','solicitud','cs'+i)"> -->
                                                <label class="form-check-label ml-2" for="checkboxSolicitud">{{!allRequiremstMarkedCurrentSubject()?'Marcar':'Desmarcar'}}</label>
                                            </div>
                                        </ng-container>
                                    </div>
                                    </th>

                                    <!-- <th scope="col">Acciones</th> -->

                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let req of currentAval.requirements.requirements; let i = index">
                                    
                                        <td  style="width: 100px;">{{i+1}}</td>
                                        <td class="ticket-desc col-md-10">
                                            <p [ngbTooltip]="req.req_name" class="mb-1 ">
                                                {{req.req_name}}
                                            </p>
                                            <small class="text-truncate"> {{req.req_type|req_requirements_type}}</small>
                                        </td>
                                        
                                        <td>
                                            <!-- <label for="primary" class="btn"> <input type="checkbox" [id]="i" class="badgebox" [name]="i"><span class="badge">&#10003;</span></label> -->
                                            <label>
                                                <!-- (change)="subjectFormChange($event)" -->
                                                <input type="checkbox" [(ngModel)]="avalReqsCheckBoxesData[i].value" [disabled]="isDPI(req.req_name)">
                                                {{avalReqsCheckBoxesData[i].value==true?'Habilitado':'Deshabilitado'}}
                                            </label>
                                            <div *ngIf="isDPI(req.req_name)">
                                                <span  [ngClass]="avalReqsCheckBoxesData[i].value == false?'label label-warning':'label label-success'">{{ avalReqsCheckBoxesData[i].value == false?'No aprobado':'Aprobado' }}</span>
                                            </div>
                                            
                                            

                                        </td>
                                      
                                        
                                        
                                    
                                    </tr>
                                    
                                    

                            </tbody>
                        </table>
                    </div>

                </div>
                <div style="display: flex; align-items: flex-end; justify-content: flex-end; margin-top: 2rem;">
                    <button class="btn text-white custom_add1" (click)="updateRequisitosEnabled(spreqconf)">
                        <i class="icon-check mr-2"></i>Guardar cambios </button>

                    <button class="btn text-white btn-color-solucredit-secondary ml-2" (click)="closeBtnClick()">
                        <i class="icon-close"></i> Rechazar </button>

                </div>

            </div>
        </div>
    </div>
</ng-template>

<ng-template #formsModal let-modal>



    <div class="modal-header">

        <h3 class="modal-title">Formularios  de {{currentSubject.name}}</h3>

        <button type="button " class="close " (click)="closeBtnClick() " aria-label="Close ">
            <span aria-hidden="true ">&times;</span>
        </button>

    </div>

    <div>
        <ngx-spinner #spinnerbitt name="spinnerbitt" bdColor="rgba(0, 0, 0, 0.8) " size="medium " color="#759ee0 "
            type="ball-atom " [fullScreen]="false ">
            <p style="color: white "> Guardando cambios </p>
        </ngx-spinner>
        <div class="modal-body">
            <div class="row">
                <div class="col-12">
                    <div class="row">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0 no-wrap v-middle">
                                <thead>
                                    <tr>
                                        <th style="position:sticky" scope="col">#</th>
                                        <th style="position: sticky; max-width: 10rem;" scope="col">Nombre formulario
                                        </th>
                                        <th style="position: sticky;" scope="col">
                                            <div style="display: flex; flex-direction: column;">
                                                Habilitar/Deshabilitar
                                                <ngx-spinner [name]="'csallforms'" bdColor="rgba(0, 0, 0, 0.8) "
                                                size="medium " color="#759ee0 " type="ball-atom " [fullScreen]="false ">
                                                <p style="color: white "> Cambiando Estatus ... </p>
                                            </ngx-spinner>
                                            <ng-container>
                                                <div class="form-check form-check-inline ">
                                                    <input type="checkbox" (change)="changeAllCheklistForms()">
                                                    <!-- <input class="form-check-input" [checked]="StatusSolicitud.check" type="checkbox" id="checkboxSolicitud" value="Solicitud" (change)="onCheckboxChange($event,'formularios','solicitud','cs'+i)"> -->
                                                    <label class="form-check-label ml-2" for="checkboxSolicitud">{{!allFormsIsMarkedCurrentSubject()?'Marcar':'Desmarcar'}}</label>
                                                </div>
                                            </ng-container>
                                        </div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="table-hover" *ngFor="let form of currentSubject.forms; let i = index">
                                        <ng-container>
                                            <!-- id="customRadio1" [name]="'type' + i"  -->
                                            <td style="position: relative;">{{i+1}}</td>
                                            <td style="max-width:20rem;">{{form.name}}</td>
                                            <td style="position: relative;padding-top:20px;padding-bottom: 20px;">

                                                <!-- <label for="primary" class="btn"> <input type="checkbox" [id]="i" class="badgebox" [name]="i"><span class="badge">&#10003;</span></label> -->
                                                <label>
                                                    <input type="checkbox"
                                                        [(ngModel)]="subjectFormsCheckBoxesData[i].value"
                                                        (change)="subjectFormChange($event)">
                                                    {{subjectFormsCheckBoxesData[i].value==true?'Habilitado':'Deshabilitado'}}
                                                </label>

                                            </td>
                                        </ng-container>

                                    </tr>
                                    <ng-container *ngIf="currentSubject.owner!=null&&currentSubject.owner!=undefined">

                                        <tr class="table-hover"
                                            *ngFor="let form of currentSubject.owner.forms;let i=index">
                                            <ng-container>
                                                <!-- id="customRadio1" [name]="'type' + i"  -->
                                                <td style="position: relative;">{{i+1+this.currentSubject.forms.length}}</td>
                                                <td>{{form.name}}</td>
                                                <td>
                                                    <!-- <label for="primary" class="btn"> <input type="checkbox" [id]="i" class="badgebox" [name]="i"><span class="badge">&#10003;</span></label> -->
                                                    <label>
                                                        <input type="checkbox"
                                                            [(ngModel)]="ownerFormsCheckBoxesData[i].value">
                                                        {{ownerFormsCheckBoxesData[i].value==true?'Habilitado':'Deshabilitado'}}
                                                    </label>
                                                </td>
                                            </ng-container>
                                        </tr>
                                    </ng-container>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-5">

                <button class="btn text-white custom_add1" (click)="saveSubFormsChanges(spinnerbitt)">
                    <i class="icon-check pr-2"></i>Guardar cambios</button>

                <button class="btn text-white btn-color-solucredit-secondary ml-2 " (click)="closeBtnClick()">
                    cancelar</button>
            </div>


        </div>


    </div>


</ng-template>


<ng-template #confirmationModal let-modal>
    <div class="modal-header">

        <h5 class="modal-title" id="editUserLabel">Confirmacion</h5>

        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>

    </div>
    <div class="modal-body">
        <div class="div-confirmation">
            <h5>¿Esta seguro que desea enviar el correo?</h5>
        </div>

        <div class="card-body div-con-flex-col div-confirmation">
            <form [formGroup]="cambiarEstadoRelacion" class="form-horizontal" (ngSubmit)="sendCustomerEmail()">
                <div class="col-sm-12 col-lg-12">
                    <div class="form-group row">
                        <label for="description" class="col-sm-12">Descripción</label>
                        <div class="input-group col-sm-12">
                            <textarea class="form-control" style="width: 100%;" id="description" formControlName="description"></textarea>
                        </div>
                        <small class="form-text text-danger col-sm-12" *ngIf="!cambiarEstadoRelacion.get('description').valid && (cambiarEstadoRelacion.get('description').dirty || cambiarEstadoRelacion.get('description').touched)">La
                                                                    información es requerida.</small>
                    </div>
                </div>
                <hr>
                <div class="card-body">
                    <div class="form-group m-b-0 text-left">
                        <button type="submit" class="btn btn-raised mr-1 text-white" style="background-color: #3473da;" [disabled]="!cambiarEstadoRelacion.valid">Enviar formulario(s)</button>
                        <button type="button" class="btn btn-raised mr-1 text-white  btn-color-solucredit-secondary" (click)="closeBtnClick()">Cancelar</button>
                    </div>
                </div>
            </form>
            
        </div>
    </div>
</ng-template>

<app-documentmodal
    [imgsrcbase64]="imgsrcbase64"
    [pdfsrcbase64]="pdfsrcbase64"
></app-documentmodal>


<ng-template #visitainicial let-modal>
    <div class="modal-header">
        <h3 class="modal-title" id="editUserLabel">Visita Inicial</h3>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <!-- <div class="container-logo text-center">
            <img src="../../../assets/images/logo-textsol.png" alt="logo">
        </div> -->
        <nz-tabset [nzSize]="'large'">
            <nz-tab [nzTitle]="'Visita inicial'">
                <form class="form-horizontal" [formGroup]="Formvisitainicial" (ngSubmit)="SaveVisitData()">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-sm-12 col-lg-6">
                                <div class="form-group row">
                                    <label for="date_of_visit" class="col-sm-12">Fecha de Visita</label>
                                    <div class="input-group col-sm-12">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                <i class=" far fa-calendar-alt"></i>
                                            </span>
                                        </div>
                                        <input type="date" class="form-control" id="date_of_visit"
                                            formControlName="date_of_visit" required placeholder="dd/mm/yyy"
                                            [(ngModel)]="visitDetails.date_of_visit">
                                    </div>
                                    <small class="form-text text-danger col-sm-12"
                                        *ngIf="!Formvisitainicial.get('date_of_visit').valid && (Formvisitainicial.get('date_of_visit').dirty || Formvisitainicial.get('date_of_visit').touched)">La
                                        fecha es requerida.</small>
                                </div>
                            </div>
                            <div class="col-sm-12 col-lg-6">
                                <div class="form-group row">
                                    <label for="business_address" class="col-sm-12">Dirección de la Empresa
                                        Visitada</label>
                                    <div class="input-group col-sm-12">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                <i class=" far fa-address-card"></i>
                                            </span>
                                        </div>
                                        <input type="text" class="form-control" id="business_address"
                                            formControlName="business_address" required
                                            placeholder="ej: 8va calle 32 -76 ...."
                                            [(ngModel)]="visitDetails.business_address">
                                    </div>
                                    <small class="form-text text-danger col-sm-12"
                                        *ngIf="!Formvisitainicial.get('business_address').valid && (Formvisitainicial.get('business_address').dirty || Formvisitainicial.get('business_address').touched)">La
                                        dirección es requerida.</small>
                                </div>
                            </div>
                            <ng-container formArrayName="participants">
                                <div *ngFor="let _ of participants.controls; index as i">
                                    <ng-container [formGroupName]="i">
                                        <div class="row form-group">
                                            <div class="col-sm-12 col-lg-6">
                                                <div class="form-group row">
                                                    <label for="name" class="col-sm-12">Nombre del Participante</label>
                                                    <div class="input-group col-sm-12">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text" id="basic-addon1">
                                                                <i class="far fa-id-card"></i>
                                                            </span>
                                                        </div>
                                                        <input type="text" class="form-control" formControlName="name"
                                                            required placeholder="ej. Juan Rodriguez">
                                                    </div>
                                                    <!-- <small class="form-text text-danger col-sm-12"
                                                        *ngIf="!Formvisitainicial.controls[0].get('position').valid && (Formvisitainicial.controls[0].get('position').dirty || Formvisitainicial.controls[0].get('position').touched)">La
                                                        dirección es requerida.</small> -->
                                                </div>
                                            </div>
                                            <div class="col-sm-12 col-lg-5">
                                                <div class="form-group row">
                                                    <label for="position" class="col-sm-12">Nombre del Puesto</label>
                                                    <div class="input-group col-sm-12">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text" id="basic-addon1">
                                                                <i class="far fa-id-card"></i>
                                                            </span>
                                                        </div>
                                                        <input type="text" class="form-control"
                                                            formControlName="position" required
                                                            placeholder="ej: Gerente">
                                                    </div>
                                                    <!-- <small class="form-text text-danger col-sm-12"
                                                        *ngIf="!Formvisitainicial.controls[1].get('position').valid && (Formvisitainicial.controls[1].get('position').dirty || Formvisitainicial.controls[1].get('position').touched)">La
                                                        dirección es requerida.</small> -->
                                                </div>
                                            </div>
                                            <div class="col-lg-1 align-self-center" *ngIf="i!=0">
                                                <button (click)="DeleteParticipant(i)"
                                                    class="btn btn-danger btn-raised mr-1"> <i
                                                        class="far fa-window-close"></i> </button>
                                            </div>
                                        </div>
                                    </ng-container>
                                </div>
                            </ng-container>
                            <div class="row" style="width: 100%;">
                                <div class="col-sm-12 col-lg-12 text-right">
                                    <button type="button" (click)="AddParticipant()"
                                        class="btn btn-success btn-raised mr-1">Agregar otra participante</button>
                                </div>
                            </div>
                            <div class="col-sm-12 col-lg-12" style="margin-bottom: 75px;">
                                <div class="form-group row">
                                    <label for="background" class="col-sm-12">Antecedentes</label>
                                    <div class="input-group col-sm-12">
                                        <quill-editor [style]="{height: '200px'}" style="width: 100%;" id="background"
                                            formControlName="background" [(ngModel)]="visitDetails.background">
                                        </quill-editor>
                                    </div>
                                    <small class="form-text text-danger col-sm-12"
                                        *ngIf="!Formvisitainicial.get('background').valid && (Formvisitainicial.get('background').dirty || Formvisitainicial.get('background').touched)">La
                                        información es requerida.</small>
                                </div>
                            </div>
                            <div class="col-sm-12 col-lg-6">
                                <label for="typeubicacion" class="col-sm-12">Seleccionar tipo de ubicacion</label>
                                <div class="form-group row">
                                    <div class="input-group col-sm-12">
                                        <div _ngcontent-bpb-c164="" class="input-group-prepend"><label
                                                _ngcontent-bpb-c164="" for="inputGroupSelect01"
                                                class="input-group-text"><i class="far fa-building"></i></label></div>
                                        <select formControlName="typeubicacion" name="typeubicacion"
                                            [(ngModel)]="seleccionType" class="custom-select col-sm-12"
                                            id="typeubicacion">
                                            <option value="" selected disabled>Selecionar...</option>
                                            <option *ngFor="let place of dataInspectionPlace" [value]="place.id_place">
                                                {{place.name_place}}</option>

                                        </select>
                                    </div>
                                    <!-- <small class="form-text text-danger col-sm-12"
                                        *ngIf="!Formvisitainicial.get('type').valid && (Formvisitainicial.get('type').dirty || Formvisitainicial.get('type').touched)">Seleccione
                                        un tipo de negocio valido.</small> -->
                                </div>
                            </div>
                            <div class="col-sm-12 col-lg-6" style="position: relative;">
                                <ngx-spinner name="csfilrvisitas" bdColor="rgba(0, 0, 0, 0.8)" size="medium"
                                    color="#759ee0" type="ball-atom" [fullScreen]="false">
                                    <p style="color: white">Subiendo Documento ... </p>
                                </ngx-spinner>
                                <div class="form-group row">
                                    <label for="fileVisita" class="col-sm-12">Seleccionar Archivo</label>
                                    <div class="input-group col-sm-12">
                                        <input [disabled]="!seleccionType&&!Formvisitainicial.valid" type="file"
                                            class="" id="fileVisita"
                                            (change)="showPreviewImage($event,'verificaciones','visitasinicial','csfilrvisitas')"
                                            accept=".pdf,image/*">
                                    </div>
                                    <!-- <small class="form-text text-danger col-sm-12"
                                        *ngIf="!Formvisitainicial.get('business_address').valid && (Formvisitainicial.get('business_address').dirty || Formvisitainicial.get('business_address').touched)">La
                                        dirección es requerida.</small> -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="card-body div-con-flex-col div-confirmation">
                            <button type="submit" class="btn btn-raised mr-1 text-white"
                                style="background-color: #3473da;" [disabled]="!Formvisitainicial.valid">Guardar
                                información</button>
                            <button type="button" class="btn btn-raised mr-1 text-white  btn-color-solucredit-secondary"
                                (click)="closeBtnClick()">Cancelar</button>
                        </div>
                    </div>
                </form>
            </nz-tab>
            <nz-tab [nzTitle]="'Empresas del Grupo/Holding'">
                <div class="card-body">
                    <form class="form-horizontal" [formGroup]="FormCompanys" (ngSubmit)="SaveCompanys()">
                        <div class="row">
                            <div class="row d-flex justify-content-center col-lg-12">
                                <div  [ngClass]="{'col-lg-3 col-md-3 col-sm-12': true}">
                                    <label for="holding" class="col-sm-12">¿Pertenecen a un grupo de empresas? </label>
                                    <div class="col-12">
                                        <div class="row form-group">
                                            <div
                                                [ngClass]="{'col-lg-4 col-md-4 col-sm-12': true}">
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" id="sipertenece" name="holding" value="1"
                                                        class="custom-control-input" formControlName="holding"
                                                      
                                                        (change)="changeHasBussiness()">
                                                    <label class="custom-control-label custom-label" for="sipertenece">Si</label>
                                                </div>
                                            </div>
                                            <div
                                                [ngClass]="{'col-lg-4 col-md-4 col-sm-12': true}">
                                                <div class="custom-control custom-radio">
                                                    <input type="radio" id="nopertenece" name="holding" value="0"
                                                        class="custom-control-input" formControlName="holding"
                                                       
                                                        (change)="changeHasBussiness()">
                                                    <label class="custom-control-label custom-label" for="nopertenece">No</label>
                                                </div>
                                            </div>
                                            <!-- <small class="form-text text-danger col-sm-12" *ngIf="!FormCompanys.get('holding').valid && (FormCompanys.get('holding').dirty || FormCompanys.get('holding').touched)">Este campo es requerido.</small> -->
                                        </div>
                    
                                    </div>
                                </div>
                            </div>
                    
                            <div class="col-lg-3 col-md-3 col-sm-12"
                                [ngClass]="{'customhidden': FormCompanys.get('comercial_name').disabled}">
                                <div class="form-group row">
                                    <label for="comercial_name" class="col-sm-12">Nombre Comercial<code
                                            style="font-size: 16px;"><sup>*</sup></code></label>
                                    <div class="input-group col-sm-12">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                <i class="fas fa-address-card"></i>
                                            </span>
                                        </div>
                                        <input type="text" class="form-control" aria-label="comercial_name" id="comercial_name_FormCompanys"
                                            formControlName="comercial_name">
                                    </div>
                                    <small class="form-text text-danger col-sm-12"
                                        *ngIf="!FormCompanys.get('comercial_name').valid && (FormCompanys.get('comercial_name').dirty || FormCompanys.get('comercial_name').touched)">Este
                                        campo es requerido.</small>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-12" [ngClass]="{'customhidden': FormCompanys.get('relation').disabled}">
                                <div class="form-group row">
                                    <label for="relation" class="col-sm-12">Relación Afiliada<code
                                            style="font-size: 16px;"><sup>*</sup></code></label>
                                    <div class="input-group col-sm-12">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                <i class="fas fa-address-card"></i>
                                            </span>
                                        </div>
                                        <input type="text" class="form-control" aria-label="relation" id="relation"
                                            formControlName="relation">
                                    </div>
                                    <small class="form-text text-danger col-sm-12"
                                        *ngIf="!FormCompanys.get('relation').valid && (FormCompanys.get('relation').dirty || FormCompanys.get('relation').touched)">Este
                                        campo es requerido.</small>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-12" [ngClass]="{'customhidden': FormCompanys.get('sector').disabled}">
                                <div class="form-group row">
                                    <label for="sector" class="col-sm-12">Sector al que Pertenece<code
                                            style="font-size: 16px;"><sup>*</sup></code></label>
                                    <div class="input-group col-sm-12">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                <i class="fas fa-address-card"></i>
                                            </span>
                                        </div>
                                        <input type="text" class="form-control" aria-label="sector" id="sector" formControlName="sector">
                                    </div>
                                    <small class="form-text text-danger col-sm-12"
                                        *ngIf="!FormCompanys.get('sector').valid && (FormCompanys.get('sector').dirty || FormCompanys.get('sector').touched)">Este
                                        campo es requerido.</small>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-12" [ngClass]="{'customhidden': FormCompanys.get('nit').disabled}">
                                <div class="form-group row">
                                    <label for="nit" class="col-sm-12">Nit<code style="font-size: 16px;"><sup>*</sup></code></label>
                                    <div class="input-group col-sm-12">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                <i class="fas fa-address-card"></i>
                                            </span>
                                        </div>
                                        <input type="text" size="8" maxlength="13" minlength="8" class="form-control" aria-label="nit"
                                            id="nit" formControlName="nit">
                                    </div>
                                    <small class="form-text text-danger col-sm-12"
                                        *ngIf="!FormCompanys.get('nit').valid && (FormCompanys.get('nit').dirty || FormCompanys.get('nit').touched)">Este
                                        campo es requerido.</small>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-12"
                                [ngClass]="{'customhidden': FormCompanys.get('holding_name').disabled}">
                                <div class="form-group row">
                                    <label for="holding_name" class="col-sm-12">Nombre la Holding<code
                                            style="font-size: 16px;"><sup>*</sup></code></label>
                                    <div class="input-group col-sm-12">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                <i class="fas fa-address-card"></i>
                                            </span>
                                        </div>
                                        <input type="text" class="form-control" aria-label="holding_name" id="holding_name"
                                            formControlName="holding_name">
                                    </div>
                                    <small class="form-text text-danger col-sm-12"
                                        *ngIf="!FormCompanys.get('holding_name').valid && (FormCompanys.get('holding_name').dirty || FormCompanys.get('holding_name').touched)">Este
                                        campo es requerido.</small>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-12" [ngClass]="{'customhidden': FormCompanys.get('country').disabled}">
                                <div class="form-group row">
                                    <label for="country" class="col-sm-12">País<code style="font-size: 16px;"><sup>*</sup></code></label>
                                    <div class="input-group-prepend col-sm-12">
                                        <label class="input-group-text">
                                            <i class="far fa-id-card"></i>
                                        </label>
                                        <select class="custom-select" formControlName="country">
                                            <!-- <option value="-1" selected>Seleccione un país...</option> -->
                                            <option *ngFor="let country of getCountry()" [value]="country">
                                                {{country}}</option>
                                        </select>
                                    </div>
                                    <small class="form-text text-danger col-sm-12"
                                        *ngIf="!FormCompanys.get('country').valid && (FormCompanys.get('country').dirty || FormCompanys.get('country').touched)">Este
                                        campo es requerido.</small>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-12"
                                [ngClass]="{'customhidden': FormCompanys.get('comercial_activity').disabled}">
                                <div class="form-group row">
                                    <label for="comercial_activity" class="col-sm-12">Actividad Comercial<code
                                            style="font-size: 16px;"><sup>*</sup></code></label>
                                    <div class="input-group col-sm-12">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="basic-addon1">
                                                <i class="fas fa-address-card"></i>
                                            </span>
                                        </div>
                                        <input type="text" class="form-control" aria-label="comercial_activity_FormCompanys"
                                            id="comercial_activity_FormCompanys" formControlName="comercial_activity">
                                    </div>
                                    <small class="form-text text-danger col-sm-12"
                                        *ngIf="!FormCompanys.get('comercial_activity').valid && (FormCompanys.get('comercial_activity').dirty || FormCompanys.get('comercial_activity').touched)">Este
                                        campo es requerido.</small>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-12" [ngClass]="{'customhidden': FormCompanys.get('company_type').disabled}">
                                <div class="form-group row">
                                    <label for="country" class="col-sm-12">Tipo<code style="font-size: 16px;"><sup>*</sup></code></label>
                                    <div class="input-group-prepend col-sm-12">
                                        <label class="input-group-text">
                                            <i class="far fa-id-card"></i>
                                        </label>
                                        <select class="custom-select" formControlName="company_type">
                                            <!-- <option value="-1" selected>Seleccione un país...</option> -->
                                            <option *ngFor="let country of getCompanyType()" [value]="country">
                                                {{country}}</option>
                                        </select>
                                    </div>
                                    <small class="form-text text-danger col-sm-12"
                                        *ngIf="!FormCompanys.get('company_type').valid && (FormCompanys.get('company_type').dirty || FormCompanys.get('company_type').touched)">Este
                                        campo es requerido.</small>
                                </div>
                            </div>
                            <div class="col-lg-3 col-md-3 col-sm-12" *ngIf="FormCompanys.get('holding').value == '1'">
                                <div class="form-group">
                                    <label for="addBtn" class="col-sm-12">&nbsp;</label>
                                    <button type="submit" [disabled]="!FormCompanys.valid" id="addBtn3"
                                    style="background-color: #3473da;"
                                    class="btn btn-raised mr-1 text-white  btn-color-solucredit-secondary">Agregar</button>
                                </div>
                            </div>
                        </div>
                    </form>
                    <div class="row mt-3" *ngIf="FormCompanys.get('holding').value == '1'">
                        <div class="col-sm-12">
                            <div class="col-sm-12">
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th scope="col" style="text-align: center;">Nombre Comercial</th>
                                                <th scope="col" style="text-align: center;">Relación Afiliada</th>
                                                <th scope="col" style="text-align: center;">Sector</th>
                                                <th scope="col" style="text-align: center;">Nit</th>
                                                <th scope="col" style="text-align: center;">Nombre Holding</th>
                                                <th scope="col" style="text-align: center;">País</th>
                                                <th scope="col" style="text-align: center;">Actividad Comercial</th>
                                                <th scope="col" style="text-align: center;">Tipo</th>
                                                <th scope="col" style="text-align: center;">Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let company of dataCompanies;let i = index">
                                                <td>{{company.comercial_name}}</td>
                                                <td>{{company.relation}}</td>
                                                <td>{{company.sector}}</td>
                                                <td>{{company.nit}}</td>
                                                <td>{{company.holding_name}}</td>
                                                <td>{{company.country}}</td>
                                                <td>{{company.company_type}}</td>
                                                <td>{{company.comercial_activity}}</td>
                                                <td>
                                                    <button class="btn btn-info waves-effect btn-rounded waves-light" type="button"
                                                        (click)="openModalCompanies(updatecompanies,i,company.company_id)"><i
                                                            class="fas fa-pencil-alt"></i></button>
                                                    <button class="btn btn-danger waves-effect btn-rounded waves-light"
                                                        type="button" (click)="DeleteSomeData(company.company_id,'company')"><i
                                                            class="fas fa-trash-alt"></i></button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            
            </nz-tab>
        </nz-tabset>


    </div>
</ng-template>

<ng-template #estadorelacion let-modal>
    <div class="modal-header">
        <h5 class="modal-title" id="editUserLabel">Bitácora de flujo de trabajo</h5>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="table-responsive table-bordered" style="background-color: #fff !important;">
            <table class="table table-striped mb-0 no-wrap v-middle customtp" cellspacing="0" cellpadding="0">
                <thead>
                    <tr>
                        <th scope="col"></th>
                        <th scope="col">Estado</th>
                        <th scope="col">Descripción</th>
                        <th scope="col">Área responsable</th>
                        <th scope="col">Fecha de transición</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="table-hover" *ngFor="let singlerelation of loginitialRelation">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-success badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-check"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Completo </h5></a>
                        </td>
                        <td>
                            <ngb-highlight [result]="singlerelation.message">
                            </ngb-highlight>
                        </td>
                        <td>
                            <ngb-highlight [result]="singlerelation.description">
                            </ngb-highlight>
                        </td>
                        <td>
                            <ngb-highlight [result]="singlerelation.employee_email">
                            </ngb-highlight>
                        </td>
                        <td>
                            {{singlerelation.date | date: 'dd/MM/yyyy HH:mm a'}}
                        </td>
                    </tr>
                    <tr class="table-hover table-info" [hidden]="initialRelation && initialRelation.status >= 0">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Creación de prospecto </td>
                        <td></td>
                        <td>supervizor.solucredit@gmail.com</td>
                        <td></td>
                    </tr>
                    <tr class="table-hover table-info" [hidden]="initialRelation && initialRelation.status >= 1">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Inicio de relación</td>
                        <td></td>
                        <td>Asistente Comercial</td>
                        <td></td>
                    </tr>
                    <tr class="table-hover table-info" [hidden]="initialRelation && initialRelation.status >= 2">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Validación datos prospecto</td>
                        <td></td>
                        <td>Prospecto (Enviado por email)</td>
                        <td></td>
                    </tr>
                    <tr class="table-hover table-info" [hidden]="initialRelation && initialRelation.status >= 3">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Validación de datos rechazada</td>
                        <td></td>
                        <td>Asistente Comercial</td>
                        <td></td>
                    </tr>
                    <tr class="table-hover table-info" [hidden]="initialRelation && initialRelation.status >= 4">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Validación de datos aceptada</td>
                        <td></td>
                        <td>Asistente Comercial</td>
                        <td></td>
                    </tr>
                    <!-- <tr class="table-hover table-info" [hidden]="initialRelation && initialRelation.status >= 5">
                        <td>Verificación datos prospecto</td>
                        <td>pendiente</td>
                        <td>sin asignar</td>
                    </tr> -->
                </tbody>
            </table>
        </div>
    </div>
</ng-template>

<ng-template #estadosolicitud let-modal>
    <div class="modal-header">
        <h3 class="modal-title" id="editUserLabel">Proceso de la Solicitud</h3>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="table-responsive table-bordered" style="background-color: #fff !important;">
            <table class="table table-striped mb-0 no-wrap v-middle customtp table-hover">
                <thead>
                    <tr>
                        <th scope="col" style="text-align: center;">Verificación</th>
                        <th scope="col" style="text-align: center;">Estado</th>
                        <th scope="col" style="text-align: center;">Descripción</th>
                        <th scope="col" style="text-align: center;">Área Responsable</th>
                        <th scope="col" style="text-align: center;">Fecha de Transición</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="table-hover" *ngFor="let logrequest of logdataRequest">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-success badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-check"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Completo </h5></a>
                        </td>
                        <td>
                            <ngb-highlight [result]="logrequest.message">
                            </ngb-highlight>
                        </td>
                        <td style="max-width: 220px; white-space: pre-wrap;">
                            {{logrequest.description}}
                        </td>
                        <td>
                            <ngb-highlight [result]="logrequest.employee_email">
                            </ngb-highlight>
                        </td>
                        <td style="text-align: center;">
                            {{logrequest.date | date: 'dd/MM/yyyy HH:mm a'}}
                        </td>
                    </tr>
                    <tr class="table-hover table-info" [hidden]="lastrequest && lastrequest.status >= 0">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Solicitud Creada</td>
                        <td></td>
                        <td>supervizor.solucredit@gmail.com</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 1">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Validar verificaciones </td>
                        <td></td>
                        <td>Asistente Comercial</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 1">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Validar verificaciones </td>
                        <td></td>
                        <td>Asistente Comercial</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 2">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Validar garantías</td>
                        <td></td>
                        <td>Asistente Comercial</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 2">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Validar garantías</td>
                        <td></td>
                        <td>Asistente Comercial</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 3">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Envío de formularios </td>
                        <td></td>
                        <td>Asistente Comercial</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 3">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Envío de formularios </td>
                        <td></td>
                        <td>Asistente Comercial</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 4">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Ingreso Datos Formularios</td>
                        <td></td>
                        <td>Prospecto (Enviado por email)</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 4">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Ingreso Datos Formularios</td>
                        <td></td>
                        <td>Prospecto (Enviado por email)</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 5">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Validar formularios</td>
                        <td></td>
                        <td>Asistente Comercial</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 5">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Validar formularios</td>
                        <td></td>
                        <td>Asistente Comercial</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 6">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Análisis Legal</td>
                        <td></td>
                        <td>Área Legal (Validación de papelería)</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 6">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Análisis Legal</td>
                        <td></td>
                        <td>Área Legal (Validación de papelería)</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 7">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Visitas de negocio</td>
                        <td></td>
                        <td>Gerencia Comercial</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 7">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Visitas de negocio</td>
                        <td></td>
                        <td>Gerencia Comercial</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 8">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Análisis de cumplimiento</td>
                        <td></td>
                        <td>Oficial de Cumplimiento</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 8">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Análisis de cumplimiento</td>
                        <td></td>
                        <td>Oficial de Cumplimiento</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 9">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Revisión de Expediente</td>
                        <td></td>
                        <td>Gerencia de Operaciones</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 9">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Revisión de Expediente</td>
                        <td></td>
                        <td>Gerencia de Operaciones</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 10">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Aprobación Comité Créditos</td>
                        <td></td>
                        <td>Área de Negociaciones</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 10">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Aprobación Comité Créditos</td>
                        <td></td>
                        <td>Área de Negociaciones</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 11">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Envío de informe de negociación</td>
                        <td></td>
                        <td>Prospecto (Envío de papelería)</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 11">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Envío de informe de negociación</td>
                        <td></td>
                        <td>Prospecto (Envío de papelería)</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 12">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Confirmación de negociación</td>
                        <td></td>
                        <td>Área de negociaciones</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 12">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Confirmación de negociación</td>
                        <td></td>
                        <td>Área de negociaciones</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 13">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Aprobación Gerencial</td>
                        <td></td>
                        <td>Gerente General</td>
                        <td></td>
                    </tr>
                    <tr *ngIf="lastrequest && lastrequest.status == 13">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                        <td>Aprobación Gerencial</td>
                        <td></td>
                        <td>Gerencia General</td>
                        <td></td>
                    </tr>
                    <tr [hidden]="lastrequest && lastrequest.status >= 14">
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> Pendiente </h5></a>
                        </td>
                        <td>Activación de cliente</td>
                        <td></td>
                        <td>Gerencia General</td>
                        <td></td>
                    </tr>
                    <!-- <tr *ngIf="lastrequest && lastrequest.status == 14">
                        <td>Activación de cliente</td>
                        <td></td>
                        <td>Gerencia General</td>
                        <td></td>
                        <td>
                            <a class="d-flex align-items-center p-2 rounded-pill bg-light mt-3 mt-md-0"><span _ngcontent-taf-c215="" class="badge badge-danger badge-pill px-3 font-weight-bold font-14"><i class="mdi mdi-alert-circle-outline"></i></span><h5 _ngcontent-taf-c215="" class="mb-0 ml-1 text-dark"> En Proceso </h5></a>
                        </td>
                    </tr> -->
                    <!-- <tr *ngFor="let singlerelation of loginitialRelation">
                        <td>
                            <ngb-highlight [result]="singlerelation.message">
                            </ngb-highlight>
                        </td>
                        <td>
                            <ngb-highlight [result]="singlerelation.description" >
                            </ngb-highlight>
                        </td>
                        <td>
                            <ngb-highlight [result]="singlerelation.employee_email">
                            </ngb-highlight>
                        </td>
                    </tr> -->
                </tbody>
            </table>
        </div>
    </div>
</ng-template>

<ng-template #cambiaedr let-modal>
    <div class="modal-header">
        <h5 class="modal-title" id="editUserLabel">Cambiar estado de relación</h5>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="card-block">
            <form [formGroup]="cambiarEstadoRelacion" class="form-horizontal" (ngSubmit)="ChangeStatusRelation()">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-12 col-lg-12">
                            <div class="form-group row">
                                <label for="description" class="col-sm-12">Descripción</label>
                                <div class="input-group col-sm-12">
                                    <textarea class="form-control" style="width: 100%;" id="description" formControlName="description"></textarea>
                                </div>
                                <small class="form-text text-danger col-sm-12" *ngIf="!cambiarEstadoRelacion.get('description').valid && (cambiarEstadoRelacion.get('description').dirty || cambiarEstadoRelacion.get('description').touched)">La
                                                                            información es requerida.</small>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="card-body">
                    <div class="form-group m-b-0 text-left">
                        <button type="submit" class="btn btn-raised mr-1 text-white" style="background-color: #3473da;" [disabled]="!cambiarEstadoRelacion.valid">Confirmar</button>
                        <button type="button" class="btn btn-raised mr-1 text-white  btn-color-solucredit-secondary" (click)="closeBtnClick()">Cancelar</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</ng-template>

<ng-template #cambiarestadosol let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="editUserLabel">Cambiar estado de solicitud</h4>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="card-block">
            <form [formGroup]="cambiarEstadoRelacion" class="form-horizontal" (ngSubmit)="ChangeStatusRequest()">
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-12 col-lg-12">
                            <div class="form-group row">
                                <label for="description" class="col-sm-12">Descripción</label>
                                <div class="input-group col-sm-12">
                                    <textarea class="form-control" style="width: 100%;" id="description" formControlName="description"></textarea>
                                </div>
                                <small class="form-text text-danger col-sm-12" *ngIf="!cambiarEstadoRelacion.get('description').valid && (cambiarEstadoRelacion.get('description').dirty || cambiarEstadoRelacion.get('description').touched)">La
                                                                            información es requerida.</small>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="card-body">
                    <div class="form-group m-b-0 text-left">
                        <button type="submit" class="btn btn-raised mr-1 text-white" style="background-color: #3473da;" [disabled]="!cambiarEstadoRelacion.valid">Confirmar</button>
                        <button type="button" class="btn btn-raised mr-1 text-white  btn-color-solucredit-secondary" (click)="closeBtnClick()">Cancelar</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</ng-template>

<ng-template #userFormsList let-modal>
    <div class="modal-header">
        <h3 class="modal-title" id="userFormsListLabel">Formularios{{userFormsListModalUsername ? ': ' + userFormsListModalUsername : '' }}</h3>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-12">
                <div *ngIf="currentSubject != null">
                    <div class="row">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0 no-wrap v-middle ">
                                <thead>
                                    <tr>
                                        <th style="position:sticky;" scope="col">#</th>
                                        <th style="position: sticky; max-width:45rem;" scope="col ">Nombre</th>
                                        <th style="position: sticky;" scope="col ">
                                            <div style="display: flex; flex-direction: column;">
                                                Estado
                                                <ngx-spinner [name]="'csallforms'" bdColor="rgba(0, 0, 0, 0.8) " size="medium " color="#759ee0 " type="ball-atom " [fullScreen]="false ">
                                                    <p style="color: white "> Cambiando Estatus ... </p>
                                                </ngx-spinner>
                                                <!-- *ngIf="canCompleteForms()" -->
                                                <ng-container>
                                                    <div class="form-check form-check-inline ">
                                                        <input type="checkbox" [(ngModel)]="completeAllCurrentForms" (change)="changeAllCurrentForms($event,csallforms)">
                                                        <!-- <input class="form-check-input" [checked]="StatusSolicitud.check" type="checkbox" id="checkboxSolicitud" value="Solicitud" (change)="onCheckboxChange($event,'formularios','solicitud','cs'+i)"> -->
                                                        <label class="form-check-label" for="checkboxSolicitud">{{completeAllCurrentForms?'Marcar como no aprobados':'Marcar como aprobados'}}</label>
                                                    </div>
                                                </ng-container>
                                            </div>
                                        </th>
                                        <!-- <th scope="col ">Subir archivos</th> -->
                                        <th style="position: sticky; max-width: 10rem;" scope="col ">Acciones</th>
                                        <th style="position: sticky; max-width: 35rem;" scope="col ">Archivos</th>
                                    </tr>
                                </thead>
                                <tbody>

                                    <tr class="table-hover " *ngFor='let form of currentSubject.forms | req_subject_disable_forms; let i = index'>
                                        <td>{{i+1}}</td>
                                        <td style="max-width:45rem;">
                                            <!-- <span style="color: #2962ff;font-weight: 500;">{{form.name}}</span> -->
                                            <p [ngbTooltip]="form.name" class="mb-1 text-truncate" style="max-width:45rem; white-space: nowrap;">
                                                {{form.name}}
                                            </p>
                                        </td>
                                        <td style="position: relative;padding-top: 20px;padding-bottom: 20px; ">
                                            <ngx-spinner [name]="'cs'+ i" bdColor="rgba(0, 0, 0, 0.8) " size="medium " color="#759ee0 " type="ball-atom " [fullScreen]="false ">
                                                <p style="color: white "> Cambiando status ... </p>
                                            </ngx-spinner>
                                            <!-- *ngIf="canCompleteForms()" -->
                                            <ng-container>
                                                <div class="form-check form-check-inline ">
                                                    <input type="checkbox" [(ngModel)]="formsCheckBoxesData[i].value" (change)="changeFormCheckStatus($event,form,i,'cs'+i,currentSubject)">
                                                    <!-- <input class="form-check-input" [checked]="StatusSolicitud.check" type="checkbox" id="checkboxSolicitud" value="Solicitud" (change)="onCheckboxChange($event,'formularios','solicitud','cs'+i)"> -->
                                                    <label class="form-check-label" for="checkboxSolicitud">Completar</label>
                                                </div>
                                            </ng-container>

                                            <span [ngClass]="form.check_status == 0 || form.check_status == null ? 'label-warning':'label-success'" class="label  font-weight-100">{{form.check_status == 0 || form.check_status == null?'No aprobado':'Aprobado'}}</span>
                                        </td>
                                        <!-- <td style="position: relative;padding-top: 20px;padding-bottom: 20px;">
                                            <ngx-spinner [name]="'s'+i" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                <p style="color: white"> Subiendo Documento ... </p>
                                            </ngx-spinner>
                                            <fieldset class="form-group">
                                                <input type="file" class="" id="exampleInputFile" (change)="UploadForm($event,form,'s'+i)">
                                            </fieldset>
                                        </td> -->
                                        <td style="position: sticky;padding-top: 20px;padding-bottom: 20px; max-width: 30rem;">
                                            <!-- <button [disabled]="currentSubject.form_id=== null" class="btn mb-2 text-white custom_add1" (click)="DownloadForm(form.name)">Descargar</button> -->
                                            <!-- <div ngbDropdown>
                                                <button class="btn mr-0 btn-outline-secondary dropdown-toggle" type="button" ngbDropdownToggle>Descargar</button>
                                                <div class="dropdown-menu" ngbDropdownMenu>
                                                    <button class="dropdown-item button-drop" (click)="DownloadJson(currentSubject.form_id)" ngbDropdownItem *ngIf="form.name=='FEIC'">Json</button>
                                                    <button class="dropdown-item button-drop" (click)="DownloadForm(form.name)" ngbDropdownItem>Excel</button>

                                                </div>
                                            </div> -->


                                            <button [disabled]="currentSubject.form_id=== null" class="btn mb-2 text-white custom_add1 btn-sm" (click)="DownloadForm(form.name,'s'+ i)">Descargar</button>
                                            <!-- <button class="btn mb-2 text-white btn-color-solucredit-secondary btn-sm" (click)="goToEditForm()">Ingresar datos</button> -->
                                            <button class="btn mb-2 text-white btn-color-solucredit-secondary btn-sm" (click)="goToEditForm2()">Ingresar datos</button>
                                            <ngx-spinner [name]="'s'+i" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                <p style="color: white"> Generando Formulario ... </p>
                                            </ngx-spinner>

                                            <!-- <fieldset class="form-group">
                                                <input type="file" class="btn mb-2 text-white custom_add1 btn-sm" id="exampleInputFile" (change)="UploadForm($event,form,'s'+i)">
                                            </fieldset> -->
                                            <input type="file" [id]="'exampleInputFile'+i" style="display: none;" (change)="UploadForm($event,form,'s'+i)" accept=".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,.xls,.xlsx,.pdf,image/*" />
                                            <label [for]="'exampleInputFile'+i" class="btn mb-2 text-white custom_add1 btn-sm">Subir archivo</label>
                                            <button *ngIf="form.name=='FEIC'" [disabled]="currentSubject.form_id=== null" class="btn mb-2 text-white btn-color-solucredit-secondary btn-sm" (click)="DownloadJson(currentSubject.form_id,currentSubject)">JSON</button>
                                        </td>

                                        <td style="max-width: 25rem;">
                                            <div *ngFor="let doc of form.docs">
                                                <div class="row">
                                                    <td style="max-width:10rem" [ngbTooltip]="doc.name_s3">{{doc.name_s3.length>15?(doc.name_s3|slice:0:15)+"...":doc.name_s3}}</td>
                                                    <td *ngIf="doc.is_visible == 1"><i style="cursor: pointer;" class="icon-eye" (click)="ViewFormDoc(viewdocuments, doc)"></i></td>
                                                    <td><i style="cursor: pointer;" class="icon-cloud-download" (click)="DownloadFormDoc(doc)"></i></td>
                                                    <td><i style="cursor: pointer;color:red" (click)="DeleteFormDoc(doc)" class="icon-trash"></i></td>
                                                </div>
                                               
                                            </div>

                                        </td>
                                    </tr>
                                    <!--Propietario-->
                                    <ng-container *ngIf="currentSubject.owner!=null&&currentSubject.owner!=undefined">
                                        <tr class="table-hover" *ngFor='let form of currentSubject.owner.forms | req_subject_disable_forms; let i = index' >
                                            <td>{{i+1+this.currentSubject.forms.length}}</td>
                                            <td style="max-width:10rem;">
                                                <!-- <span style="color: #2962ff;font-weight: 500;">{{form.name}}</span> -->
                                                <p [ngbTooltip]="form.name" class="mb-1 text-truncate" style="width:10rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                                                    {{form.name}}
                                                </p>
                                            </td>
                                            <td style="position: relative;padding-top: 20px;padding-bottom: 20px; ">
                                                <ngx-spinner [name]="'cs_'+ i" bdColor="rgba(0, 0, 0, 0.8) " size="medium " color="#759ee0 " type="ball-atom " [fullScreen]="false ">
                                                    <p style="color: white "> Cambiando status ... </p>
                                                </ngx-spinner>
                                                <!-- *ngIf="canCompleteForms()" -->
                                                <ng-container>
                                                    <div class="form-check form-check-inline ">
                                                        <input type="checkbox" [(ngModel)]="ownerFormsCheckBoxesData[i].value" (change)="changeFormCheckStatus($event,form,i,'cs_'+i,currentSubject.owner)">
                                                        <!-- <input class="form-check-input" [checked]="StatusSolicitud.check" type="checkbox" id="checkboxSolicitud" value="Solicitud" (change)="onCheckboxChange($event,'formularios','solicitud','cs'+i)"> -->
                                                        <label class="form-check-label" for="checkboxSolicitud">Completar</label>
                                                    </div>
                                                </ng-container>
    
                                                <span [ngClass]="form.check_status == 0 || form.check_status == null ? 'label-warning':'label-success'" class="label  font-weight-100">{{form.check_status == 0 || form.check_status == null?'No aprobado':'Aprobado'}}</span>
                                            </td>
                                            <td style="position: sticky;padding-top: 20px;padding-bottom: 20px; max-width: 30rem;">
                                                <button [disabled]="currentSubject.owner.form_id=== null" class="btn mb-2 text-white custom_add1 btn-sm" (click)="DownloadOwnerForm(form.name,'s_'+ i)">Descargar</button>
                                                <!-- <button class="btn mb-2 text-white btn-color-solucredit-secondary btn-sm" (click)="goToEditForm()">Ingresar datos</button> -->
                                                <button class="btn mb-2 text-white btn-color-solucredit-secondary btn-sm" (click)="goToEditFormOwner()">Ingresar datos</button>
                                                <ngx-spinner [name]="'s_'+i" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#759ee0" type="ball-atom" [fullScreen]="false">
                                                    <p style="color: white"> Generando Formulario ... </p>
                                                </ngx-spinner>
    
                                                <!-- <fieldset class="form-group">
                                                    <input type="file" class="btn mb-2 text-white custom_add1 btn-sm" id="exampleInputFile" (change)="UploadForm($event,form,'s'+i)">
                                                </fieldset> -->
                                                <input type="file" [id]="'exampleInputFile_'+i" style="display: none;" (change)="UploadOwnerForm($event,form,'s_'+i)" accept=".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,.xls,.xlsx,.pdf,image/*" />
                                                <label [for]="'exampleInputFile_'+i" class="btn mb-2 text-white custom_add1 btn-sm">Subir archivo</label>
                                                <button *ngIf="form.name=='FEIC'" [disabled]="currentSubject.owner.form_id=== null" class="btn mb-2 text-white btn-color-solucredit-secondary btn-sm" (click)="DownloadJson(currentSubject.owner.form_id,currentSubject.owner)">JSON</button>
                                            </td>
                                            <td style="max-width: 25rem;">
                                                <div *ngFor="let doc of form.docs">
                                                    <div class="row">
                                                        <td  [ngbTooltip]="doc.name_s3">{{doc.name_s3.length>15?(doc.name_s3|slice:0:15)+"...":doc.name_s3}}</td>
                                                        <td *ngIf="doc.is_visible == 1"><i style="cursor: pointer;" class="icon-eye" (click)="ViewFormDoc(viewdocuments, doc)"></i></td>
                                                        <td><i style="cursor: pointer;" class="icon-cloud-download" (click)="DownloadFormDoc(doc)"></i></td>
                                                        <td><i style="cursor: pointer;color:red" (click)="DeleteOwnerFormDoc(doc)" class="icon-trash"></i></td>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </ng-container>

                                    <tr *ngIf="this.StatusSolicitud.check && this.StatusPerfil.check && this.StatusFeic.check && this.StatusIve.check && this.StatusCpe.check && this.Statuspep.check && this.StatusAuto.check && this.StatusCarta.check && this.StatusEstado.check && this.StatusFlujos.check && this.StatusEndeudamiento.check && this.StatusFormato.check && this.StatusDeudores.check">
                                        <td></td>
                                        <td>Completar Formularios</td>
                                        <td style="position: relative;padding-top: 20px;padding-bottom: 20px;"></td>
                                        <td style="position: relative;padding-top: 20px;padding-bottom: 20px;"></td>
                                        <td></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div *ngIf="currentSubject == null" style="display: flex; align-items: center; justify-content: center;">
                    <h4>Debes de seleccionar un elemento del panel izquierdo.</h4>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<!--REVISISON ANALYSIS-->
<ng-template #modalOnuDetail let-modal>
    <div class="modal-header">
        <h5 class="modal-title text-center" id="editUserLabel">Revisión Detallada</h5>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body scroll">
        <div class="card-header" style="background-color: #2061c4;">
            <h4 class="m-b-0 text-white" style="text-align: center;">Concurrencias en Listas ONU</h4>
        </div>
        <div class="row">
            <div class="col-lg-12">

                
                    <div class="form-group row col-md-12">
                        <table class="table table-responsive-lg table-hover no-wrap v-middle white-table">
                            <thead class="table-striped">
                                <tr>
                                    <th scope="col">Código cliente</th>
                                    <th scope="col">Nombre Completo</th>
                                    <th scope="col">Validación</th>
                                    <th scope="col">FIRST_NAME</th>
                                    <th scope="col">SECOND_NAME</th>
                                    <th scope="col">COMMENT</th>
                                    <th scope="col">COMENTARIO</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let user of selectedOnuList">
                                    <td>
                                        {{user.customer.customer_id}}
                                    </td>
                                    <td>
                                        <ngb-highlight *ngIf="user.customer.customer_id" [result]="user.customer.name" ></ngb-highlight>

                                        <ngb-highlight style="padding-right: 4px; " *ngIf="user.customer.person_id" [result]="user.customer.first_name " ></ngb-highlight>
                                        <ngb-highlight *ngIf="user.customer.person_id" [result]=" user.customer.last_name "></ngb-highlight>
        
                                        <ngb-highlight style="padding-right: 4px; " *ngIf="user.customer.id_fiduciary" [result]="user.customer.name1 " ></ngb-highlight>
                                        <ngb-highlight style="padding-right: 4px; " *ngIf="user.customer.id_fiduciary" [result]="user.customer.name2 "></ngb-highlight>
                                        <ngb-highlight style="padding-right: 4px; " *ngIf="user.customer.id_fiduciary" [result]="user.customer.name3 " ></ngb-highlight>
                                        <ngb-highlight style="padding-right: 4px; " *ngIf="user.customer.id_fiduciary" [result]="user.customer.lastname1 " ></ngb-highlight>
                                        <ngb-highlight style="padding-right: 4px;" *ngIf="user.customer.id_fiduciary" [result]="user.customer.lastname2 "></ngb-highlight>
                                        <ngb-highlight *ngIf="user.customer.id_fiduciary" [result]="user.customer.lastname3 " ></ngb-highlight>
                                    </td>
                                    <td>
                                        {{user.date | date: 'dd/MM/yyyy'}}
                                    </td>
                                    <td>
                                        <ngb-highlight [result]="user.onu.FIRST_NAME" ></ngb-highlight>
                                    </td>
                                    <td>
                                        <ngb-highlight [result]="user.onu.SECOND_NAME"></ngb-highlight>
                                    </td>
                                    <td style="width: 200px !important;white-space: normal !important;">
                                        <ngb-highlight [result]="user.onu.COMMENTS1"></ngb-highlight>
                                    </td>
                                    <td style="width: 200px !important;white-space: normal !important;" *ngIf="user.customer.person_id">
                                        <span>{{user.description_lock}}</span>
                                    </td>
                                    <td style="width: 200px !important;white-space: normal !important;" *ngIf="user.customer.id_fiduciary">
                                        <span>{{user.description_lock}}</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <hr>
                
            </div>
        </div>
    </div>
</ng-template>
<ng-template #modalRevisionDetallada let-modal>
    <div class="modal-header">
        <h5 class="modal-title text-center" id="editUserLabel">Revisión Detallada</h5>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
    </div>
    
    <div class="modal-body"> 
        <div class="card-header" style="background-color: #2061c4;">
            <h4 class="m-b-0 text-white" style="text-align: center;">Check List Revisión Detallada</h4>
        </div>
        <div class="row">
            <div class="col-lg-12">

                <form class="form-horizontal" [formGroup]="FormCheckListCA">
                    <div class="form-group row col-md-12">
                        <table class="table table-responsive-lg table-hover no-wrap v-middle white-table">
                            <thead class="table-striped">
                              <tr>
                                <th 
                                    *ngFor="let header of dataList2.metadata">
                                    <div style="text-align: center;">
                                        {{header}}
                                    </div>
                                </th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr
                                *ngFor="let ver of actualVerificationsDoc"
                              >
                              <td>
                                <div style="text-align: center;">
                                    <p>{{ver.doc_type|slice:0:50}} - {{ver.nombre}}</p>
                                </div>
                           </td>
                               <td>
                                    <div style="text-align: center;">
                                        <label>
                                            <input type="checkbox"
                                            [checked]="ver.bit_value=='true'"
                                            (change)="onChangeStatusCheckList(ver)" /> Si
                                          </label>
                                          <label>
                                            <input type="checkbox"
                                            [checked]="ver.bit_value=='false'||ver.bit_value=='0'"
                                            (change)="onChangeStatusCheckListNo(ver)" /> No
                                        </label>
                                    </div>
                                </td>
                                <td>
                                    <div style="text-align: center;">
                                        {{ver.comment == '0' ? 'No se ha agregado' : ver.comment}}
                                    </div>
                                </td>
                                <td>
                                    <div *ngIf="ver.ad_s3key != 0" style="text-align: center;">
                                        <i style="cursor: pointer;color:red" class="icon-trash" (click)="deleteCheckDocs(ver)"></i>
                                    </div>
                                    <div *ngIf="ver.ad_s3key == 0" style="text-align: center;">
                                        <button 
                                        [disabled]="ver.id_checklist == 0" 
                                        type="button" 
                                        data-toggle="modal" 
                                        class="btn btn ml-auto btn-info" 
                                        (click)="openModalUploadDocCheck(modalUploadDocsCheck, ver)">Cargar 
                                        <i class="fas fa-cloud-upload-alt"></i></button>
                                    </div>
                                    
                                </td>
                                
                                
                              </tr>
                            </tbody>
                          </table>
                    </div>
                    <hr>
                    
                    <div class="form-group m-b-0 text-right">
                        <button type="button" class="btn btn-raised mr-1 text-white btn-color-solucredit" style="align-items: flex-end;" (click)="openReport(targetReport)">Generar Informe</button>
                        <button class="btn btn-raised mr-1 text-white btn-color-solucredit-secondary" (click)="modal.dismiss('cerrar')">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</ng-template>


<ng-template #modalCheckListAnalysis let-modal>
    <div class="modal-header">
        <h5 class="modal-title text-center" id="editUserLabel">Revisión Detallada</h5>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
    </div>
    
    <div class="modal-body"> 
        <div class="card-header" style="background-color: #2061c4;">
            <h4 class="m-b-0 text-white" style="text-align: center;">Check List Revisión Detallada</h4>
        </div>
        <div class="row">
            <div class="col-lg-12">

                <form class="form-horizontal" [formGroup]="FormCheckListCA">
                    <div class="form-group row col-md-12" style="align-content: center;">
                        <table class="table table-responsive-lg v-middle white-table">
                            <thead class="table-striped">
                                <tr>
                                    <th *ngFor="let header of dataChecklistAnalysis.metadata">
                                        <div style="text-align: center;">
                                            {{header}}
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let ver of dataChecklistAnalysis.data">
                                    <td>
                                        <div style="text-align: center;">
                                            <p>{{ver.doc_type|slice:0:50}} - {{ver.nombre}}</p>
                                        </div>
                                    </td>
                                    <td>
                                        <div style="text-align: center;">
                                            <label
                                            style="margin-right: 10px"
                                            >
                                                <input 
                                                style="align-items: center;"
                                                type="checkbox"
                                                [checked]="ver.bit_value=='true'"
                                                (change)="onChangeStatusCheckList(ver)"
                                                 /> Si 
                                              </label>
                                              
                                              <label>
                                                <input 
                                                style="align-items: center;"
                                                type="checkbox"
                                                [checked]="ver.bit_value=='false'||ver.bit_value=='0'"
                                                (change)="onChangeStatusCheckList(ver)" /> No
                                            </label>
                                        </div>
                                    </td>
                                    <td>
                                        <div style="max-width: 400px; text-align: justify;">
                                            {{ver.comment == '0' ? 'No se ha agregado' : ver.comment}}
                                        </div>
                                    </td>
                                    <td>
                                        
                                        <div *ngIf="ver.ad_s3key != 0" style="text-align: center;">
                                            <tr>
                                                <td>
                                                    <i style="cursor: pointer;" class=" icon-eye"
                                                        *ngIf="ver.filename.includes('jpg')||ver.filename.includes('pdf')||ver.filename.includes('png')||ver.filename.includes('jpeg')"
                                                        (click)="ViewAnalysisDocumentChecklist(ver,viewdocuments)"></i>
                                                </td>
                                                <td>
                                                    <i style="cursor: pointer;" class="fas fa-cloud-download-alt"
                                                        (click)="DownloadChecklistAnalysisDocument(ver)"
                                                    >
                                                    </i>
                                                </td>
                                                <td>
                                                    <i style="cursor: pointer;color:red" class="icon-trash" (click)="deleteCheckDocs(ver)"></i>
                                                </td>
                                                
                                        
                                            </tr>
                                            
                                           
                                            
                                        </div>
                                        <div *ngIf="ver.ad_s3key == 0" style="text-align: center;">
                                            <button 
                                            [disabled]="ver.id_checklist == 0" 
                                            type="button" 
                                            data-toggle="modal" 
                                            class="btn btn ml-auto btn-info" 
                                            (click)="openModalUploadDocCheck(modalUploadDocsCheck, ver)">Cargar 
                                            <i class="fas fa-cloud-upload-alt"></i></button>
                                        </div>
                        
                                    </td>
                        
                        
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <hr>
                    
                    <div class="form-group m-b-0 text-right">
                        <button type="button" class="btn btn-raised mr-1 text-white btn-color-solucredit" style="align-items: flex-end;" (click)="openReport(targetReport)">Generar Informe</button>
                        <button class="btn btn-raised mr-1 text-white btn-color-solucredit-secondary" (click)="modal.dismiss('cerrar')">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</ng-template>


<ng-template #modalRevisionAdicional let-modal>
    <div class="modal-header">
        <h5 class="modal-title text-center" id="editUserLabel">Revisión Detallada</h5>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
    </div>
    
    <div class="modal-body"> 
        <div class="card-header" style="background-color: #2061c4;">
            <h4 class="m-b-0 text-white" style="text-align: center;">Check List Revisión Adicional</h4>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <!--<div class="card-header" style="background-color: #2061c4;">
                    <h4 class="m-b-0 text-white" style="text-align: center;">Editar Monto y Moneda</h4>
                </div>-->
                <form class="form-horizontal" [formGroup]="FormCheckListCA">
                    <div class="form-group row col-md-12">
                        <table class="table">
                            <thead class="table-striped">
                                <tr>
                                    <th *ngFor="let header of dataChecklistAnalysis.metadata">
                                        <div style="text-align: center;">
                                            {{header}}
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let ver of dataChecklistAnalysis.data">
                                    <td>
                                        <div style="text-align: center;">
                                            <p>{{ver.doc_type|slice:0:50}}</p>
                                        </div>
                                    </td>
                                    <td>
                                        <div style="text-align: center;">
                                            <label>
                                                <input type="checkbox" [checkbox]="'ver.bit_value'" (change)="onChangeStatusCheckList(ver)" />
                                            </label>
                                        </div>
                                    </td>
                                    <td>
                                        <div style="text-align: center;">
                                            {{'Comentario'}}
                                        </div>
                                    </td>
                                    <td>
                                        <div *ngIf="ver.ad_s3key != 0" style="text-align: center;">
                                            <i style="cursor: pointer;color:red" class="icon-trash" (click)="deleteCheckDocs(ver)"></i>
                                        </div>
                                        <div *ngIf="ver.ad_s3key == 0" style="text-align: center;">
                                            <button [disabled]="ver.id_checklist == 0" type="button" data-toggle="modal"
                                                class="btn btn ml-auto btn-info" (click)="openModalUploadDoc(modalUploadDocs, null)">Cargar <i
                                                    class="fas fa-cloud-upload-alt"></i></button>
                                        </div>
                        
                                    </td>
                        
                        
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <hr>
                    
                    <div class="form-group m-b-0 text-right">
                        <button type="button" class="btn btn-raised mr-1 text-white btn-color-solucredit" style="align-items: flex-end;" (click)="openReport(targetReport)">Generar Informe</button>
                        <button type="button" class="btn btn-raised mr-1 text-white btn-color-solucredit" style="align-items: flex-end;">Revisión Adicional</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</ng-template>



<ng-template #modalRevisionAdicional let-modal>
    <div class="modal-header">
        <h5 class="modal-title text-center" id="editUserLabel">Revisión Detallada</h5>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
    </div>
    
    <div class="modal-body"> 
        <div class="card-header" style="background-color: #2061c4;">
            <h4 class="m-b-0 text-white" style="text-align: center;">Check List Revisión Adicional</h4>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <!--<div class="card-header" style="background-color: #2061c4;">
                    <h4 class="m-b-0 text-white" style="text-align: center;">Editar Monto y Moneda</h4>
                </div>-->
                <form class="form-horizontal" [formGroup]="FormCheckListCA">
                    <div class="form-group row col-md-12">
                        <table class="table">
                            <thead class="table-striped">
                              <tr>
                                <th scope="col">#</th>
                                <th scope="col" style="text-align: center;">Documento</th>
                                <th scope="col" style="text-align: center;">Verificación</th>
                                <th scope="col" style="text-align: center;">Acciones</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <th scope="row">1</th>
                                <td>DPI</td>
                                <td>Revisión Adicional <input type="checkbox"></td>
                                <td>Ver/Eliminar</td>
                              </tr>
                              <tr>
                                <th scope="row">2</th>
                                <td>Patente</td>
                                <td>Revisión Adicional <input type="checkbox"></td>
                                <td>Ver/Eliminar</td>
                              </tr>
                              <tr>
                                <th scope="row">3</th>
                                <td>Inicio de Relación</td>
                                <td>Revisión Adicional <input type="checkbox"></td>
                                <td>Ver/Eliminar</td>
                              </tr>
                            </tbody>
                          </table>
                    </div>
                    <hr>
                    
                    <div class="form-group m-b-0 text-right">
                        <button type="button" class="btn btn-raised mr-1 text-white btn-color-solucredit" style="align-items: flex-end;">Generar Informe</button>
                        <button class="btn btn-raised mr-1 text-white btn-color-solucredit-secondary" (click)="modal.dismiss('cerrar')">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</ng-template>
<ng-template #modalUploadDocs let-modal>
    <div class="modal-header text-center">
        <h3 class="modal-title" id="editUserLabel">Evidencias y Documentos Respaldo </h3>
        <button id="updateMemberClose" type="button" class="close" (click)="modal.dismiss('cerrar')" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">

        <div style="display: flex; flex-direction: column;">
            
            <div class="card-block">
                <form [formGroup]="FormUploadDocumentsCA" class="form-horizontal">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="form-group row">
                                    <label for="prod_serv_other_signers" class="col-sm-12">Comentario:</label>
                                    <div class="input-group col-sm-12">
                                        <textarea type="text" class="form-control .module" aria-label="comment" id="comment"
                                            formControlName="uploaddocsca_comment" style="width: 50%" rows="2">
                                        </textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div style="display: flex; justify-content: center; align-items: center;">
                <input type="file" [id]="'exampleInputFile'+i" style="display: none;"
                    [disabled]="!FormUploadDocumentsCA.valid" (change)="uploadDocsCA($event,doc,'s'+i)"
                    accept=".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,.xls,.xlsx,.pdf,image/*" />
                <button class="btn mb-2 text-white custom_add1 btn-sm" [disabled]="!FormUploadDocumentsCA.valid"
                    style="display: block;">
                    <label [for]="'exampleInputFile'+i"> <i class=" far fa-edit mr-3"></i>Subir archivo</label>
                </button>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #modalUploadDocsCheck let-modal>
    <div class="modal-header text-center">
        <h3 class="modal-title" id="editUserLabel">Cargar Documentos</h3>
        <button id="updateMemberClose" type="button" class="close" (click)="modal.dismiss('cerrar')" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">

        <div style="display: flex; flex-direction: column;">
            
            <div class="card-block">
                <form [formGroup]="FormCheckListCA " class="form-horizontal">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="form-group row">
                                    <label for="prod_serv_other_signers" class="col-sm-12">Comentario:</label>
                                    <div class="input-group col-sm-12">
                                        <textarea type="text" class="form-control .module" aria-label="comment" id="comment"
                                            formControlName="checklist_comment" style="width: 50%" rows="2">
                                        </textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div style="display: flex; justify-content: center; align-items: center;">
                <input type="file" [id]="'exampleInputFile'+i" style="display: none;"
                    [disabled]="!FormCheckListCA.valid" (change)="uploadDocCheckList($event,doc,'s'+i)"
                    accept=".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,.xls,.xlsx,.pdf,image/*" />
                <button class="btn mb-2 text-white custom_add1 btn-sm" [disabled]="!FormCheckListCA.valid"
                    style="display: block;">
                    <label [for]="'exampleInputFile'+i"> <i class=" far fa-edit mr-3"></i>Subir archivo</label>
                </button>
            </div>

        </div>


    </div>
</ng-template>
<ng-template #modalSendMail let-modal>
    <div class="modal-header text-center">
        <h3 class="modal-title" id="editUserLabel">Notificar Revisión Adicional</h3>
        <button id="updateMemberClose" type="button" class="close" (click)="modal.dismiss('cerrar')" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">

        <div style="display: flex; flex-direction: column;">
            
            <div class="card-block">
                <form [formGroup]="FormAditionalRev" class="form-horizontal" (ngSubmit)="onCreate()">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12">
                                <div class="form-group row">
                                    <label for="prod_serv_other_signers" class="col-sm-12">Comentario:</label>
                                    <div class="input-group col-sm-12">
                                        <textarea type="text" class="form-control .module" aria-label="comment" id="comment"
                                            formControlName="aditionalrev_comment" style="width: 50%" rows="8">
                                        </textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; justify-content: center; align-items: center;">
                        <button type="submit" class="btn btn-raised mr-1 text-white" [disabled]="!FormAditionalRev.valid"
                            style="background-color: #3473da;">Solicitar Revisión</button>
                    </div>
                </form>
            </div>
            

        </div>


    </div>
</ng-template>

<ng-template #updatecompanies let-modal>
    <div class="modal-header">
        <h3 class="modal-title" id="editUserLabel">Editar Información de la Compañia</h3>
        <button type="button" class="close" (click)="closeBtnClick()" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="card-block">
            <form class="form-horizontal" [formGroup]="FormUpdateCompanys" (ngSubmit)="UpdateCompanys()">
                <div class="row">
                    <div class="col-lg-6 col-md-6 col-sm-12">
                        <div class="form-group row">
                            <label for="comercial_name" class="col-sm-12">Nombre Comercial<code
                                    style="font-size: 16px;"><sup>*</sup></code></label>
                            <div class="input-group col-sm-12">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">
                                        <i class="fas fa-address-card"></i>
                                    </span>
                                </div>
                                <input type="text" class="form-control" aria-label="comercial_name" id="comercial_name"
                                    formControlName="comercial_name">
                            </div>
                            <small class="form-text text-danger col-sm-12"
                                *ngIf="!FormUpdateCompanys.get('comercial_name').valid && (FormUpdateCompanys.get('comercial_name').dirty || FormUpdateCompanys.get('comercial_name').touched)">Este
                                campo es requerido.</small>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12">
                        <div class="form-group row">
                            <label for="relation" class="col-sm-12">Relación afiliada<code
                                    style="font-size: 16px;"><sup>*</sup></code></label>
                            <div class="input-group col-sm-12">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">
                                        <i class="fas fa-address-card"></i>
                                    </span>
                                </div>
                                <input type="text" class="form-control" aria-label="relation" id="relation"
                                    formControlName="relation">
                            </div>
                            <small class="form-text text-danger col-sm-12"
                                *ngIf="!FormUpdateCompanys.get('relation').valid && (FormUpdateCompanys.get('relation').dirty || FormUpdateCompanys.get('relation').touched)">Este
                                campo es requerido.</small>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12">
                        <div class="form-group row">
                            <label for="sector" class="col-sm-12">Sector al que pertenece<code
                                    style="font-size: 16px;"><sup>*</sup></code></label>
                            <div class="input-group col-sm-12">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">
                                        <i class="fas fa-address-card"></i>
                                    </span>
                                </div>
                                <input type="text" class="form-control" aria-label="sector" id="sector"
                                    formControlName="sector">
                            </div>
                            <small class="form-text text-danger col-sm-12"
                                *ngIf="!FormUpdateCompanys.get('sector').valid && (FormUpdateCompanys.get('sector').dirty || FormUpdateCompanys.get('sector').touched)">Este
                                campo es requerido.</small>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12">
                        <div class="form-group row">
                            <label for="nit" class="col-sm-12">Nit<code
                                    style="font-size: 16px;"><sup>*</sup></code></label>
                            <div class="input-group col-sm-12">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">
                                        <i class="fas fa-address-card"></i>
                                    </span>
                                </div>
                                <input type="text" size="8" maxlength="13" minlength="8" class="form-control" aria-label="nit" id="nit"
                                    formControlName="nit">
                            </div>
                            <small class="form-text text-danger col-sm-12"
                                *ngIf="!FormUpdateCompanys.get('nit').valid && (FormUpdateCompanys.get('nit').dirty || FormUpdateCompanys.get('nit').touched)">Este
                                campo es requerido.</small>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12">
                        <div class="form-group row">
                            <label for="holding_name" class="col-sm-12">Nombre la holding<code
                                    style="font-size: 16px;"><sup>*</sup></code></label>
                            <div class="input-group col-sm-12">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">
                                        <i class="fas fa-address-card"></i>
                                    </span>
                                </div>
                                <input type="text" class="form-control" aria-label="holding_name" id="holding_name"
                                    formControlName="holding_name">
                            </div>
                            <small class="form-text text-danger col-sm-12"
                                *ngIf="!FormUpdateCompanys.get('holding_name').valid && (FormUpdateCompanys.get('holding_name').dirty || FormUpdateCompanys.get('holding_name').touched)">Este
                                campo es requerido.</small>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12">
                        <div class="form-group row">
                            <label for="country" class="col-sm-12">País<code
                                    style="font-size: 16px;"><sup>*</sup></code></label>
                            <div class="input-group-prepend col-sm-12">
                                <label class="input-group-text">
                                    <i class="far fa-id-card"></i>
                                </label>
                                <select class="custom-select" id="country" formControlName="country">
                                    <!-- <option value="-1" selected>Seleccione un banco...</option> -->
                                    <option *ngFor="let country of getCountry()" [value]="country">{{country}}</option>
                                </select>
                            </div>
                            <small class="form-text text-danger col-sm-12"
                                *ngIf="!FormUpdateCompanys.get('country').valid && (FormUpdateCompanys.get('country').dirty || FormUpdateCompanys.get('country').touched)">Este
                                campo es requerido.</small>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12">
                        <div class="form-group row">
                            <label for="comercial_activity" class="col-sm-12">Actividad comercial<code
                                    style="font-size: 16px;"><sup>*</sup></code></label>
                            <div class="input-group col-sm-12">
                                <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">
                                        <i class="fas fa-address-card"></i>
                                    </span>
                                </div>
                                <input type="text" class="form-control" aria-label="comercial_activity"
                                    id="comercial_activity_FormUpdateCompanys" formControlName="comercial_activity">
                            </div>
                            <small class="form-text text-danger col-sm-12"
                                *ngIf="!FormUpdateCompanys.get('comercial_activity').valid && (FormUpdateCompanys.get('comercial_activity').dirty || FormUpdateCompanys.get('comercial_activity').touched)">Este
                                campo es requerido.</small>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-12">
                        <div class="form-group row">
                            <label for="country" class="col-sm-12">Tipo<code
                                    style="font-size: 16px;"><sup>*</sup></code></label>
                            <div class="input-group-prepend col-sm-12">
                                <label class="input-group-text">
                                    <i class="far fa-id-card"></i>
                                </label>
                                <select class="custom-select" id="company_type" formControlName="company_type">
                                    <!-- <option value="-1" selected>Seleccione un banco...</option> -->
                                    <option *ngFor="let country of getCompanyType()" [value]="country">{{country}}</option>
                                </select>
                            </div>
                            <small class="form-text text-danger col-sm-12"
                                *ngIf="!FormUpdateCompanys.get('company_type').valid && (FormUpdateCompanys.get('company_type').dirty || FormUpdateCompanys.get('company_type').touched)">Este
                                campo es requerido.</small>
                        </div>
                    </div>
                    <div class="col-lg-12 col-md-12 col-sm-12">
                        <div class="form-group">
                            <label for="addBtn" class="col-sm-12">&nbsp;</label>
                            <button type="submit" [disabled]="!FormUpdateCompanys.valid" id="addBtn41"
                            style="background-color: #3473da;"
                            class="btn btn-raised mr-1 text-white">Guardar</button>
                            <button type="button" class="btn btn-raised mr-1 text-white  btn-color-solucredit-secondary"
                                (click)="closeBtnClick()">Regresar</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</ng-template>
